**********************
Windows PowerShell 脚本开始
开始时间: 20230411114639
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 6312
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>. 'C:\Users\wangjian\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1'
PS C:\Windows\system32> Invoke-AtomicTest T1218.011-1 -Cleanup
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-1 Rundll32 execute JavaScript Remote Payload With GetObject

成功: 已终止进程 "notepad.exe"，其 PID 为 4024。
成功: 已终止进程 "notepad.exe"，其 PID 为 18996。
Done executing cleanup for test:
T1218.011-1 Rundll32 execute JavaScript Remote Payload With GetObject

PS C:\Windows\system32> cd C:\KGraph\AtomicRun
PS C:\KGraph\AtomicRun> Invoke-AtomicTest  -Cleanup
>> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
PS C:\KGraph\AtomicRun> .\AtomicRunALL-2.ps1
T1547.001-1
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing test:
T1547.001-1 Reg Key Run

操作成功完成。
Done executing test:
T1547.001-1 Reg Key Run

**********************
Windows PowerShell 脚本开始
开始时间: 20230411114751
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 6312
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“另一个进程正在使用此文件，因此该进程无法访问此文件。”
Move-Item : 另一个进程正在使用此文件，因此该进程无法访问此文件。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:17 字符: 3
+   Move-Item $files.FullName $newPath -Force
+   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : WriteError: (D:\MyLab\collec...11-11-47-51.out:FileInfo) [Move-Item], IOException
    + FullyQualifiedErrorId : MoveFileInfoItemIOError,Microsoft.PowerShell.Commands.MoveItemCommand
Move-Item : 另一个进程正在使用此文件，因此该进程无法访问此文件。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:17 字符: 3
+   Move-Item $files.FullName $newPath -Force
+   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : WriteError: (D:\MyLab\collec...11-11-47-51.out:FileInfo) [Move-Item], IOException
    + FullyQualifiedErrorId : MoveFileInfoItemIOError,Microsoft.PowerShell.Commands.MoveItemCommand
Move-Item : 另一个进程正在使用此文件，因此该进程无法访问此文件。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:17 字符: 3
+   Move-Item $files.FullName $newPath -Force
+   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : WriteError: (D:\MyLab\collec...11-11-47-51.out:FileInfo) [Move-Item], IOException
    + FullyQualifiedErrorId : MoveFileInfoItemIOError,Microsoft.PowerShell.Commands.MoveItemCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1547.001-1 Reg Key Run

Done executing cleanup for test:
T1547.001-1 Reg Key Run

T1547.001-2
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing test:
T1547.001-2 Reg Key RunOnce

操作成功完成。
Done executing test:
T1547.001-2 Reg Key RunOnce

**********************
Windows PowerShell 脚本开始
开始时间: 20230411114753
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 6312
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“There is not exactly one .txt file in the source folder.”
RenameAndMoveFile : There is not exactly one .txt file in the source folder.
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:30 字符: 6
+      RenameAndMoveFile -sourceFolder "D:\MyLab\collector\APTETWCollec ...
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,RenameAndMoveFile
RenameAndMoveFile : There is not exactly one .txt file in the source folder.
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:30 字符: 6
+      RenameAndMoveFile -sourceFolder "D:\MyLab\collector\APTETWCollec ...
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,RenameAndMoveFile
RenameAndMoveFile : There is not exactly one .txt file in the source folder.
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:30 字符: 6
+      RenameAndMoveFile -sourceFolder "D:\MyLab\collector\APTETWCollec ...
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,RenameAndMoveFile

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1547.001-2 Reg Key RunOnce

Done executing cleanup for test:
T1547.001-2 Reg Key RunOnce

T1547.001-3
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing test:
T1547.001-3 PowerShell Registry RunOnce

Done executing test:
T1547.001-3 PowerShell Registry RunOnce

**********************
Windows PowerShell 脚本开始
开始时间: 20230411114756
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 6312
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“There is not exactly one .txt file in the source folder.”
RenameAndMoveFile : There is not exactly one .txt file in the source folder.
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:30 字符: 6
+      RenameAndMoveFile -sourceFolder "D:\MyLab\collector\APTETWCollec ...
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,RenameAndMoveFile
RenameAndMoveFile : There is not exactly one .txt file in the source folder.
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:30 字符: 6
+      RenameAndMoveFile -sourceFolder "D:\MyLab\collector\APTETWCollec ...
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,RenameAndMoveFile
RenameAndMoveFile : There is not exactly one .txt file in the source folder.
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:30 字符: 6
+      RenameAndMoveFile -sourceFolder "D:\MyLab\collector\APTETWCollec ...
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,RenameAndMoveFile

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1547.001-3 PowerShell Registry RunOnce

Done executing cleanup for test:
T1547.001-3 PowerShell Registry RunOnce

T1547.001-4
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing test:
T1547.001-4 Suspicious vbs file run from startup Folder

Microsoft (R) Windows Script Host Version 5.812
版权所有(C) Microsoft Corporation。保留所有权利。
T1547.001 Hello, World VBS!
Microsoft (R) Windows Script Host Version 5.812
版权所有(C) Microsoft Corporation。保留所有权利。
T1547.001 Hello, World VBS!
Done executing test:
T1547.001-4 Suspicious vbs file run from startup Folder

**********************
Windows PowerShell 脚本开始
开始时间: 20230411114759
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 6312
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“There is not exactly one .txt file in the source folder.”
RenameAndMoveFile : There is not exactly one .txt file in the source folder.
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:30 字符: 6
+      RenameAndMoveFile -sourceFolder "D:\MyLab\collector\APTETWCollec ...
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,RenameAndMoveFile
RenameAndMoveFile : There is not exactly one .txt file in the source folder.
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:30 字符: 6
+      RenameAndMoveFile -sourceFolder "D:\MyLab\collector\APTETWCollec ...
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,RenameAndMoveFile
RenameAndMoveFile : There is not exactly one .txt file in the source folder.
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:30 字符: 6
+      RenameAndMoveFile -sourceFolder "D:\MyLab\collector\APTETWCollec ...
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,RenameAndMoveFile

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1547.001-4 Suspicious vbs file run from startup Folder

Done executing cleanup for test:
T1547.001-4 Suspicious vbs file run from startup Folder

T1547.001-5
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing test:
T1547.001-5 Suspicious jse file run from startup Folder

Microsoft (R) Windows Script Host Version 5.812
版权所有(C) Microsoft Corporation。保留所有权利。
T1547.001 Hello, World JSE!
Microsoft (R) Windows Script Host Version 5.812
版权所有(C) Microsoft Corporation。保留所有权利。
T1547.001 Hello, World JSE!
Done executing test:
T1547.001-5 Suspicious jse file run from startup Folder

**********************
Windows PowerShell 脚本开始
开始时间: 20230411114803
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 6312
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“There is not exactly one .txt file in the source folder.”
RenameAndMoveFile : There is not exactly one .txt file in the source folder.
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:30 字符: 6
+      RenameAndMoveFile -sourceFolder "D:\MyLab\collector\APTETWCollec ...
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,RenameAndMoveFile
RenameAndMoveFile : There is not exactly one .txt file in the source folder.
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:30 字符: 6
+      RenameAndMoveFile -sourceFolder "D:\MyLab\collector\APTETWCollec ...
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,RenameAndMoveFile
RenameAndMoveFile : There is not exactly one .txt file in the source folder.
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:30 字符: 6
+      RenameAndMoveFile -sourceFolder "D:\MyLab\collector\APTETWCollec ...
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,RenameAndMoveFile

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1547.001-5 Suspicious jse file run from startup Folder

Done executing cleanup for test:
T1547.001-5 Suspicious jse file run from startup Folder

T1218.011-1
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing test:
T1218.011-1 Rundll32 execute JavaScript Remote Payload With GetObject

Done executing test:
T1218.011-1 Rundll32 execute JavaScript Remote Payload With GetObject

**********************
Windows PowerShell 脚本开始
开始时间: 20230411114808
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 6312
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“There is not exactly one .txt file in the source folder.”
RenameAndMoveFile : There is not exactly one .txt file in the source folder.
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:30 字符: 6
+      RenameAndMoveFile -sourceFolder "D:\MyLab\collector\APTETWCollec ...
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,RenameAndMoveFile
RenameAndMoveFile : There is not exactly one .txt file in the source folder.
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:30 字符: 6
+      RenameAndMoveFile -sourceFolder "D:\MyLab\collector\APTETWCollec ...
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,RenameAndMoveFile
RenameAndMoveFile : There is not exactly one .txt file in the source folder.
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:30 字符: 6
+      RenameAndMoveFile -sourceFolder "D:\MyLab\collector\APTETWCollec ...
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,RenameAndMoveFile

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-1 Rundll32 execute JavaScript Remote Payload With GetObject

成功: 已终止进程 "notepad.exe"，其 PID 为 18188。
成功: 已终止进程 "notepad.exe"，其 PID 为 632。
Done executing cleanup for test:
T1218.011-1 Rundll32 execute JavaScript Remote Payload With GetObject

T1218.011-2
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing test:
T1218.011-2 Rundll32 execute VBscript command

Done executing test:
T1218.011-2 Rundll32 execute VBscript command

**********************
Windows PowerShell 脚本开始
开始时间: 20230411114813
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 6312
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“There is not exactly one .txt file in the source folder.”
RenameAndMoveFile : There is not exactly one .txt file in the source folder.
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:30 字符: 6
+      RenameAndMoveFile -sourceFolder "D:\MyLab\collector\APTETWCollec ...
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,RenameAndMoveFile
RenameAndMoveFile : There is not exactly one .txt file in the source folder.
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:30 字符: 6
+      RenameAndMoveFile -sourceFolder "D:\MyLab\collector\APTETWCollec ...
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,RenameAndMoveFile
RenameAndMoveFile : There is not exactly one .txt file in the source folder.
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:30 字符: 6
+      RenameAndMoveFile -sourceFolder "D:\MyLab\collector\APTETWCollec ...
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,RenameAndMoveFile

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-2 Rundll32 execute VBscript command

Done executing cleanup for test:
T1218.011-2 Rundll32 execute VBscript command

**********************
Windows PowerShell 脚本开始
开始时间: 20230411114815
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 6312
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到名为“ETWDataCollectorRedesigned”的进程。请验证该进程名称，然后再次调用 cmdlet。”
Get-Process : 找不到名为“ETWDataCollectorRedesigned”的进程。请验证该进程名称，然后再次调用 cmdlet。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:32 字符: 6
+      Get-Process -Name "ETWDataCollectorRedesigned" | Stop-Process
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (ETWDataCollectorRedesigned:String) [Get-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenName,Microsoft.PowerShell.Commands.GetProcessCommand
Get-Process : 找不到名为“ETWDataCollectorRedesigned”的进程。请验证该进程名称，然后再次调用 cmdlet。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:32 字符: 6
+      Get-Process -Name "ETWDataCollectorRedesigned" | Stop-Process
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (ETWDataCollectorRedesigned:String) [Get-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenName,Microsoft.PowerShell.Commands.GetProcessCommand
Get-Process : 找不到名为“ETWDataCollectorRedesigned”的进程。请验证该进程名称，然后再次调用 cmdlet。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:32 字符: 6
+      Get-Process -Name "ETWDataCollectorRedesigned" | Stop-Process
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (ETWDataCollectorRedesigned:String) [Get-Process], ProcessCommandExcepti
   on
    + FullyQualifiedErrorId : NoProcessFoundForGivenName,Microsoft.PowerShell.Commands.GetProcessCommand

T1218.011-3
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing test:
T1218.011-3 Rundll32 execute VBscript command using Ordinal number

PS C:\KGraph\AtomicRun> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
PS C:\KGraph\AtomicRun> .\AtomicRunALL-2.ps1
T1547.001-1
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing test:
T1547.001-1 Reg Key Run

操作成功完成。
Done executing test:
T1547.001-1 Reg Key Run

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1547.001-1 Reg Key Run

Done executing cleanup for test:
T1547.001-1 Reg Key Run

T1547.001-2
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing test:
T1547.001-2 Reg Key RunOnce

操作成功完成。
Done executing test:
T1547.001-2 Reg Key RunOnce

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1547.001-2 Reg Key RunOnce

Done executing cleanup for test:
T1547.001-2 Reg Key RunOnce

PS C:\KGraph\AtomicRun> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
PS C:\KGraph\AtomicRun> Invoke-AtomicTest T1547.001-2 -Cleanup
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1547.001-2 Reg Key RunOnce

Done executing cleanup for test:
T1547.001-2 Reg Key RunOnce

PS C:\KGraph\AtomicRun> .\AtomicRunALL-2.ps1
T1547.001-1
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing test:
T1547.001-1 Reg Key Run

操作成功完成。
Done executing test:
T1547.001-1 Reg Key Run

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1547.001-1 Reg Key Run

Done executing cleanup for test:
T1547.001-1 Reg Key Run

T1547.001-2
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing test:
T1547.001-2 Reg Key RunOnce

操作成功完成。
Done executing test:
T1547.001-2 Reg Key RunOnce

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1547.001-2 Reg Key RunOnce

Done executing cleanup for test:
T1547.001-2 Reg Key RunOnce

T1547.001-3
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing test:
T1547.001-3 PowerShell Registry RunOnce

Done executing test:
T1547.001-3 PowerShell Registry RunOnce

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1547.001-3 PowerShell Registry RunOnce

Done executing cleanup for test:
T1547.001-3 PowerShell Registry RunOnce

PS C:\KGraph\AtomicRun> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
PS C:\KGraph\AtomicRun> Invoke-AtomicTest T1218.011-1 
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing test:
T1218.011-1 Rundll32 execute JavaScript Remote Payload With GetObject

Process Timed out after 120 seconds, use '-TimeoutSeconds' to specify a different timeout
Done executing test:
T1218.011-1 Rundll32 execute JavaScript Remote Payload With GetObject

PS C:\KGraph\AtomicRun> Invoke-AtomicTest T1547.001-1
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing test:
T1547.001-1 Reg Key Run

操作成功完成。
Done executing test:
T1547.001-1 Reg Key Run

PS C:\KGraph\AtomicRun> .\AtomicRunALL-2.ps1
T1547.001-1
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing test:
T1547.001-1 Reg Key Run

操作成功完成。
Done executing test:
T1547.001-1 Reg Key Run

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1547.001-1 Reg Key Run

Done executing cleanup for test:
T1547.001-1 Reg Key Run

T1547.001-2
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing test:
T1547.001-1 Reg Key Run

操作成功完成。
Done executing test:
T1547.001-1 Reg Key Run

PS C:\KGraph\AtomicRun> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
