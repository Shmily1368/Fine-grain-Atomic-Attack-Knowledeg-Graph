**********************
Windows PowerShell 脚本开始
开始时间: 20230411095710
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 8432
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>. 'C:\Users\wangjian\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1'
PS C:\Windows\system32> cd C:\KGraph\AtomicRun
PS C:\KGraph\AtomicRun> .\AtomicRunALL.ps1
**********************
Windows PowerShell 脚本开始
开始时间: 20230411095714
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 8432
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“所在位置 C:\KGraph\AtomicRun\AtomicRunALL.ps1:33 字符: 31
+ ... derPath = ""D:\MyLab\collector\APTETWCollector0823-1213\APTETWCollect ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
表达式或语句中包含意外的标记“D:\MyLab\collector\APTETWCollector0823-1213\APTETWCollector0823\JSONDate""”。”
所在位置 C:\KGraph\AtomicRun\AtomicRunALL.ps1:33 字符: 31
+ ... derPath = ""D:\MyLab\collector\APTETWCollector0823-1213\APTETWCollect ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
表达式或语句中包含意外的标记“D:\MyLab\collector\APTETWCollector0823-1213\APTETWCollector0823\JSONDate""”。
    + CategoryInfo          : ParserError: (:) [], ParseException
    + FullyQualifiedErrorId : UnexpectedToken
所在位置 C:\KGraph\AtomicRun\AtomicRunALL.ps1:33 字符: 31
+ ... derPath = ""D:\MyLab\collector\APTETWCollector0823-1213\APTETWCollect ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
表达式或语句中包含意外的标记“D:\MyLab\collector\APTETWCollector0823-1213\APTETWCollector0823\JSONDate""”。
    + CategoryInfo          : ParserError: (:) [], ParseException
    + FullyQualifiedErrorId : UnexpectedToken
所在位置 C:\KGraph\AtomicRun\AtomicRunALL.ps1:33 字符: 31
+ ... derPath = ""D:\MyLab\collector\APTETWCollector0823-1213\APTETWCollect ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
表达式或语句中包含意外的标记“D:\MyLab\collector\APTETWCollector0823-1213\APTETWCollector0823\JSONDate""”。
    + CategoryInfo          : ParserError: (:) [], ParseException
    + FullyQualifiedErrorId : UnexpectedToken

PS C:\KGraph\AtomicRun> cd KGraph
**********************
Windows PowerShell 脚本开始
开始时间: 20230411095724
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 8432
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到路径“C:\KGraph\AtomicRun\KGraph”，因为该路径不存在。”
cd : 找不到路径“C:\KGraph\AtomicRun\KGraph”，因为该路径不存在。
所在位置 行:1 字符: 1
+ cd KGraph
+ ~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (C:\KGraph\AtomicRun\KGraph:String) [Set-Location], ItemNotFoundException
    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.SetLocationCommand
cd : 找不到路径“C:\KGraph\AtomicRun\KGraph”，因为该路径不存在。
所在位置 行:1 字符: 1
+ cd KGraph
+ ~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (C:\KGraph\AtomicRun\KGraph:String) [Set-Location], ItemNotFoundException
    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.SetLocationCommand
cd : 找不到路径“C:\KGraph\AtomicRun\KGraph”，因为该路径不存在。
所在位置 行:1 字符: 1
+ cd KGraph
+ ~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (C:\KGraph\AtomicRun\KGraph:String) [Set-Location], ItemNotFoundExceptio
   n
    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.SetLocationCommand

PS C:\KGraph\AtomicRun> .\AtomicRunALL.ps1
**********************
Windows PowerShell 脚本开始
开始时间: 20230411095731
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 8432
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“所在位置 C:\KGraph\AtomicRun\AtomicRunALL.ps1:33 字符: 31
+ ... derPath = ""D:\MyLab\collector\APTETWCollector0823-1213\APTETWCollect ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
表达式或语句中包含意外的标记“D:\MyLab\collector\APTETWCollector0823-1213\APTETWCollector0823\JSONDate""”。”
所在位置 C:\KGraph\AtomicRun\AtomicRunALL.ps1:33 字符: 31
+ ... derPath = ""D:\MyLab\collector\APTETWCollector0823-1213\APTETWCollect ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
表达式或语句中包含意外的标记“D:\MyLab\collector\APTETWCollector0823-1213\APTETWCollector0823\JSONDate""”。
    + CategoryInfo          : ParserError: (:) [], ParseException
    + FullyQualifiedErrorId : UnexpectedToken
所在位置 C:\KGraph\AtomicRun\AtomicRunALL.ps1:33 字符: 31
+ ... derPath = ""D:\MyLab\collector\APTETWCollector0823-1213\APTETWCollect ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
表达式或语句中包含意外的标记“D:\MyLab\collector\APTETWCollector0823-1213\APTETWCollector0823\JSONDate""”。
    + CategoryInfo          : ParserError: (:) [], ParseException
    + FullyQualifiedErrorId : UnexpectedToken
所在位置 C:\KGraph\AtomicRun\AtomicRunALL.ps1:33 字符: 31
+ ... derPath = ""D:\MyLab\collector\APTETWCollector0823-1213\APTETWCollect ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
表达式或语句中包含意外的标记“D:\MyLab\collector\APTETWCollector0823-1213\APTETWCollector0823\JSONDate""”。
    + CategoryInfo          : ParserError: (:) [], ParseException
    + FullyQualifiedErrorId : UnexpectedToken

PS C:\KGraph\AtomicRun> .\AtomicRunALL.ps1
T1218.011-1
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing test:
T1218.011-1 Rundll32 execute JavaScript Remote Payload With GetObject

**********************
Windows PowerShell 脚本开始
开始时间: 20230411095820
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 8432
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“使用“0”个参数调用“Start”时发生异常:“拒绝访问。””
使用“0”个参数调用“Start”时发生异常:“拒绝访问。”
所在位置 C:\AtomicRedTeam\invoke-atomicredteam\Private\Invoke-Process.ps1:46 字符: 17
+                 $process.Start() > $null
+                 ~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException
    + FullyQualifiedErrorId : Win32Exception
使用“0”个参数调用“Start”时发生异常:“拒绝访问。”
所在位置 C:\AtomicRedTeam\invoke-atomicredteam\Private\Invoke-Process.ps1:46 字符: 17
+                 $process.Start() > $null
+                 ~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException
    + FullyQualifiedErrorId : Win32Exception
使用“0”个参数调用“Start”时发生异常:“拒绝访问。”
所在位置 C:\AtomicRedTeam\invoke-atomicredteam\Private\Invoke-Process.ps1:46 字符: 17
+                 $process.Start() > $null
+                 ~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException
    + FullyQualifiedErrorId : Win32Exception

Done executing test:
T1218.011-1 Rundll32 execute JavaScript Remote Payload With GetObject

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-1 Rundll32 execute JavaScript Remote Payload With GetObject

成功: 已终止进程 "notepad.exe"，其 PID 为 9572。
Done executing cleanup for test:
T1218.011-1 Rundll32 execute JavaScript Remote Payload With GetObject

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
PS C:\KGraph\AtomicRun> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
>> TerminatingError():“管道已被停止。”
PS C:\KGraph\AtomicRun> .\AtomicRunALL.ps1
T1218.011-1
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing test:
T1218.011-1 Rundll32 execute JavaScript Remote Payload With GetObject

