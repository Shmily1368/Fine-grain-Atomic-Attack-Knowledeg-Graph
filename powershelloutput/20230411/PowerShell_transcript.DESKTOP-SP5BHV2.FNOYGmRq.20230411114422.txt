**********************
Windows PowerShell 脚本开始
开始时间: 20230411114422
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 16156
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>. 'C:\Users\wangjian\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1'
PS C:\Windows\system32> Invoke-AtomicTest T1547.001-1 -Cleanup
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1547.001-1 Reg Key Run

Done executing cleanup for test:
T1547.001-1 Reg Key Run

PS C:\Windows\system32> Invoke-AtomicTest T1218.011-1 -Cleanup
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-1 Rundll32 execute JavaScript Remote Payload With GetObject

错误: 没有找到进程 "notepad.exe"。
Done executing cleanup for test:
T1218.011-1 Rundll32 execute JavaScript Remote Payload With GetObject

PS C:\Windows\system32> cd C:\KGraph\AtomicRun
PS C:\KGraph\AtomicRun> .\AtomicRunALL-2.ps1
T1218.011-1
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing test:
T1218.011-1 Rundll32 execute JavaScript Remote Payload With GetObject

Done executing test:
T1218.011-1 Rundll32 execute JavaScript Remote Payload With GetObject

**********************
Windows PowerShell 脚本开始
开始时间: 20230411114506
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 16156
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“另一个进程正在使用此文件，因此该进程无法访问此文件。”
Move-Item : 另一个进程正在使用此文件，因此该进程无法访问此文件。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:17 字符: 3
+   Move-Item $files.FullName $newPath -Force
+   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : WriteError: (D:\MyLab\collec...11-11-44-44.out:FileInfo) [Move-Item], IOException
    + FullyQualifiedErrorId : MoveFileInfoItemIOError,Microsoft.PowerShell.Commands.MoveItemCommand
Move-Item : 另一个进程正在使用此文件，因此该进程无法访问此文件。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:17 字符: 3
+   Move-Item $files.FullName $newPath -Force
+   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : WriteError: (D:\MyLab\collec...11-11-44-44.out:FileInfo) [Move-Item], IOException
    + FullyQualifiedErrorId : MoveFileInfoItemIOError,Microsoft.PowerShell.Commands.MoveItemCommand
Move-Item : 另一个进程正在使用此文件，因此该进程无法访问此文件。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:17 字符: 3
+   Move-Item $files.FullName $newPath -Force
+   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : WriteError: (D:\MyLab\collec...11-11-44-44.out:FileInfo) [Move-Item], IOException
    + FullyQualifiedErrorId : MoveFileInfoItemIOError,Microsoft.PowerShell.Commands.MoveItemCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-1 Rundll32 execute JavaScript Remote Payload With GetObject

成功: 已终止进程 "notepad.exe"，其 PID 为 5368。
Done executing cleanup for test:
T1218.011-1 Rundll32 execute JavaScript Remote Payload With GetObject

T1218.011-2
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing test:
T1218.011-2 Rundll32 execute VBscript command

Done executing test:
T1218.011-2 Rundll32 execute VBscript command

**********************
Windows PowerShell 脚本开始
开始时间: 20230411114543
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 16156
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“There is not exactly one .txt file in the source folder.”
RenameAndMoveFile : There is not exactly one .txt file in the source folder.
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:31 字符: 6
+      RenameAndMoveFile -sourceFolder "D:\MyLab\collector\APTETWCollec ...
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,RenameAndMoveFile
RenameAndMoveFile : There is not exactly one .txt file in the source folder.
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:31 字符: 6
+      RenameAndMoveFile -sourceFolder "D:\MyLab\collector\APTETWCollec ...
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,RenameAndMoveFile
RenameAndMoveFile : There is not exactly one .txt file in the source folder.
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:31 字符: 6
+      RenameAndMoveFile -sourceFolder "D:\MyLab\collector\APTETWCollec ...
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,RenameAndMoveFile

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-2 Rundll32 execute VBscript command

Done executing cleanup for test:
T1218.011-2 Rundll32 execute VBscript command

T1218.011-3
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing test:
T1218.011-3 Rundll32 execute VBscript command using Ordinal number

Done executing test:
T1218.011-3 Rundll32 execute VBscript command using Ordinal number

**********************
Windows PowerShell 脚本开始
开始时间: 20230411114547
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 16156
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“There is not exactly one .txt file in the source folder.”
RenameAndMoveFile : There is not exactly one .txt file in the source folder.
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:31 字符: 6
+      RenameAndMoveFile -sourceFolder "D:\MyLab\collector\APTETWCollec ...
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,RenameAndMoveFile
RenameAndMoveFile : There is not exactly one .txt file in the source folder.
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:31 字符: 6
+      RenameAndMoveFile -sourceFolder "D:\MyLab\collector\APTETWCollec ...
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,RenameAndMoveFile
RenameAndMoveFile : There is not exactly one .txt file in the source folder.
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-2.ps1:31 字符: 6
+      RenameAndMoveFile -sourceFolder "D:\MyLab\collector\APTETWCollec ...
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,RenameAndMoveFile

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-3 Rundll32 execute VBscript command using Ordinal number

Done executing cleanup for test:
T1218.011-3 Rundll32 execute VBscript command using Ordinal number

T1218.011-4
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing test:
T1218.011-4 Rundll32 advpack.dll Execution

