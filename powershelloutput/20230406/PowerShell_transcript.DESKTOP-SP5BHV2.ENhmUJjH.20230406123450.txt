**********************
Windows PowerShell 脚本开始
开始时间: 20230406123450
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 5232
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>. 'C:\Users\wangjian\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1'
PS C:\Users\wangjian> Invoke-AtomicTest T1547.001 -3 -Cleanup
>> TerminatingError(Invoke-AtomicTest):“找不到接受实际参数“-3”的位置形式参数。”
**********************
Windows PowerShell 脚本开始
开始时间: 20230406142748
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 5232
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到接受实际参数“-3”的位置形式参数。”
Invoke-AtomicTest : 找不到接受实际参数“-3”的位置形式参数。
所在位置 行:1 字符: 1
+ Invoke-AtomicTest T1547.001 -3 -Cleanup
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [Invoke-AtomicTest]，ParameterBindingException
    + FullyQualifiedErrorId : PositionalParameterNotFound,Invoke-AtomicTest
Invoke-AtomicTest : 找不到接受实际参数“-3”的位置形式参数。
所在位置 行:1 字符: 1
+ Invoke-AtomicTest T1547.001 -3 -Cleanup
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [Invoke-AtomicTest]，ParameterBindingException
    + FullyQualifiedErrorId : PositionalParameterNotFound,Invoke-AtomicTest
Invoke-AtomicTest : 找不到接受实际参数“-3”的位置形式参数。
所在位置 行:1 字符: 1
+ Invoke-AtomicTest T1547.001 -3 -Cleanup
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [Invoke-AtomicTest]，ParameterBindingException
    + FullyQualifiedErrorId : PositionalParameterNotFound,Invoke-AtomicTest

PS C:\Users\wangjian> Invoke-AtomicTest T1547.001-3 -Cleanup
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1547.001-3 PowerShell Registry RunOnce

Done executing cleanup for test:
T1547.001-3 PowerShell Registry RunOnce

PS C:\Users\wangjian> Invoke-AtomicTest T1547.001-3
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing test:
T1547.001-3 PowerShell Registry RunOnce

set-itemproperty : 不允许所请求的注册表访问权。
所在位置 行:2 字符: 1
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+ set-itemproperty $RunOnceKey "NextRun" 'powershell.exe "IEX (New-Obje ...
    + CategoryInfo          : PermissionDenied: (HKEY_LOCAL_MACH...Version\RunOnce:String) [Set-ItemProperty], Securit 
   yException
    + FullyQualifiedErrorId : System.Security.SecurityException,Microsoft.PowerShell.Commands.SetItemPropertyCommand
Done executing test:
T1547.001-3 PowerShell Registry RunOnce

