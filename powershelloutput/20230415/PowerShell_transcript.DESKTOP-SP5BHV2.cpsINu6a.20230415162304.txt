**********************
Windows PowerShell 脚本开始
开始时间: 20230415162304
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>. 'C:\Users\wangjian\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1'
PS C:\Windows\system32> cd C:\KGraph\AtomicRun
PS C:\KGraph\AtomicRun> .\AtomicRunALL-3.ps1
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-1 Rundll32 execute JavaScript Remote Payload With GetObject

成功: 已终止进程 "notepad.exe"，其 PID 为 13700。
Done executing cleanup for test:
T1218.011-1 Rundll32 execute JavaScript Remote Payload With GetObject

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.011-1 Rundll32 execute JavaScript Remote Payload With GetObject

No Preqs Defined


T1218.011-1
**********************
Windows PowerShell 脚本开始
开始时间: 20230415162357
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 9220 的进程。”
Stop-Process : 找不到进程标识符为 9220 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9220:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 9220 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9220:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 9220 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9220:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-1 Rundll32 execute JavaScript Remote Payload With GetObject

错误: 没有找到进程 "notepad.exe"。
Done executing cleanup for test:
T1218.011-1 Rundll32 execute JavaScript Remote Payload With GetObject

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-2 Rundll32 execute VBscript command

Done executing cleanup for test:
T1218.011-2 Rundll32 execute VBscript command

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.011-2 Rundll32 execute VBscript command

No Preqs Defined


T1218.011-2
**********************
Windows PowerShell 脚本开始
开始时间: 20230415162444
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 6396 的进程。”
Stop-Process : 找不到进程标识符为 6396 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (6396:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 6396 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (6396:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 6396 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (6396:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-2 Rundll32 execute VBscript command

Done executing cleanup for test:
T1218.011-2 Rundll32 execute VBscript command

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-3 Rundll32 execute VBscript command using Ordinal number

Done executing cleanup for test:
T1218.011-3 Rundll32 execute VBscript command using Ordinal number

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.011-3 Rundll32 execute VBscript command using Ordinal number

No Preqs Defined


T1218.011-3
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-3 Rundll32 execute VBscript command using Ordinal number

Done executing cleanup for test:
T1218.011-3 Rundll32 execute VBscript command using Ordinal number

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-4 Rundll32 advpack.dll Execution

Done executing cleanup for test:
T1218.011-4 Rundll32 advpack.dll Execution

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.011-4 Rundll32 advpack.dll Execution

Attempting to satisfy prereq:
Inf file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.011\src\T1218.011.inf)

Prereq already met:
Inf file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.011\src\T1218.011.inf)

T1218.011-4
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-4 Rundll32 advpack.dll Execution

Done executing cleanup for test:
T1218.011-4 Rundll32 advpack.dll Execution

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-5 Rundll32 ieadvpack.dll Execution

Done executing cleanup for test:
T1218.011-5 Rundll32 ieadvpack.dll Execution

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.011-5 Rundll32 ieadvpack.dll Execution

Attempting to satisfy prereq:
Inf file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.011\src\T1218.011.inf)

Prereq already met:
Inf file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.011\src\T1218.011.inf)

T1218.011-5
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-5 Rundll32 ieadvpack.dll Execution

Done executing cleanup for test:
T1218.011-5 Rundll32 ieadvpack.dll Execution

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-6 Rundll32 syssetup.dll Execution

Done executing cleanup for test:
T1218.011-6 Rundll32 syssetup.dll Execution

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.011-6 Rundll32 syssetup.dll Execution

Attempting to satisfy prereq:
Inf file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.011\src\T1218.011_DefaultInstall.inf)

Prereq already met:
Inf file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.011\src\T1218.011_DefaultInstall.inf)

T1218.011-6
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-6 Rundll32 syssetup.dll Execution

Done executing cleanup for test:
T1218.011-6 Rundll32 syssetup.dll Execution

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-7 Rundll32 setupapi.dll Execution

Done executing cleanup for test:
T1218.011-7 Rundll32 setupapi.dll Execution

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.011-7 Rundll32 setupapi.dll Execution

Attempting to satisfy prereq:
Inf file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.011\src\T1218.011_DefaultInstall.inf)

Prereq already met:
Inf file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.011\src\T1218.011_DefaultInstall.inf)

T1218.011-7
**********************
Windows PowerShell 脚本开始
开始时间: 20230415162845
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 12704 的进程。”
Stop-Process : 找不到进程标识符为 12704 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12704:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 12704 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12704:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 12704 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12704:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-7 Rundll32 setupapi.dll Execution

Done executing cleanup for test:
T1218.011-7 Rundll32 setupapi.dll Execution

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-8 Execution of HTA and VBS Files using Rundll32 and URL.dll

Done executing cleanup for test:
T1218.011-8 Execution of HTA and VBS Files using Rundll32 and URL.dll

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.011-8 Execution of HTA and VBS Files using Rundll32 and URL.dll

No Preqs Defined


T1218.011-8
**********************
Windows PowerShell 脚本开始
开始时间: 20230415162932
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 10496 的进程。”
Stop-Process : 找不到进程标识符为 10496 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10496:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 10496 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10496:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 10496 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10496:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-8 Execution of HTA and VBS Files using Rundll32 and URL.dll

Done executing cleanup for test:
T1218.011-8 Execution of HTA and VBS Files using Rundll32 and URL.dll

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-9 Launches an executable using Rundll32 and pcwutl.dll

Done executing cleanup for test:
T1218.011-9 Launches an executable using Rundll32 and pcwutl.dll

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.011-9 Launches an executable using Rundll32 and pcwutl.dll

No Preqs Defined


T1218.011-9
**********************
Windows PowerShell 脚本开始
开始时间: 20230415163019
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 8556 的进程。”
Stop-Process : 找不到进程标识符为 8556 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8556:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 8556 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8556:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 8556 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8556:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-9 Launches an executable using Rundll32 and pcwutl.dll

Done executing cleanup for test:
T1218.011-9 Launches an executable using Rundll32 and pcwutl.dll

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-10 Execution of non-dll using rundll32.exe

Done executing cleanup for test:
T1218.011-10 Execution of non-dll using rundll32.exe

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.011-10 Execution of non-dll using rundll32.exe

Attempting to satisfy prereq:
Non-dll file must exist on disk at specified location

Prereq successfully met:
Non-dll file must exist on disk at specified location

T1218.011-10
**********************
Windows PowerShell 脚本开始
开始时间: 20230415163118
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 1776 的进程。”
Stop-Process : 找不到进程标识符为 1776 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (1776:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 1776 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (1776:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 1776 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (1776:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-10 Execution of non-dll using rundll32.exe

Done executing cleanup for test:
T1218.011-10 Execution of non-dll using rundll32.exe

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-11 Rundll32 with Ordinal Value

Done executing cleanup for test:
T1218.011-11 Rundll32 with Ordinal Value

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.011-11 Rundll32 with Ordinal Value

Attempting to satisfy prereq:
DLL file must exist on disk at specified location

Prereq already met:
DLL file must exist on disk at specified location

T1218.011-11
**********************
Windows PowerShell 脚本开始
开始时间: 20230415163209
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 8116 的进程。”
Stop-Process : 找不到进程标识符为 8116 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8116:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 8116 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8116:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 8116 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8116:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-11 Rundll32 with Ordinal Value

Done executing cleanup for test:
T1218.011-11 Rundll32 with Ordinal Value

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-12 Rundll32 with Control_RunDLL

Done executing cleanup for test:
T1218.011-12 Rundll32 with Control_RunDLL

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.011-12 Rundll32 with Control_RunDLL

Attempting to satisfy prereq:
DLL file must exist on disk at specified location

Prereq already met:
DLL file must exist on disk at specified location

T1218.011-12
**********************
Windows PowerShell 脚本开始
开始时间: 20230415163258
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 13808 的进程。”
Stop-Process : 找不到进程标识符为 13808 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13808:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13808 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13808:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13808 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13808:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-12 Rundll32 with Control_RunDLL

Done executing cleanup for test:
T1218.011-12 Rundll32 with Control_RunDLL

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-13 Rundll32 with desk.cpl

找不到 C:\Users\wangjian\AppData\Local\Temp\not_an_scr.scr
Done executing cleanup for test:
T1218.011-13 Rundll32 with desk.cpl

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.011-13 Rundll32 with desk.cpl

No Preqs Defined


T1218.011-13
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.011-13 Rundll32 with desk.cpl

Done executing cleanup for test:
T1218.011-13 Rundll32 with desk.cpl

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1216.001-1 PubPrn.vbs Signed Script Bypass

Done executing cleanup for test:
T1216.001-1 PubPrn.vbs Signed Script Bypass

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1216.001-1 PubPrn.vbs Signed Script Bypass

No Preqs Defined


T1216.001-1
**********************
Windows PowerShell 脚本开始
开始时间: 20230415163431
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 12716 的进程。”
Stop-Process : 找不到进程标识符为 12716 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12716:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 12716 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12716:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 12716 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12716:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1216.001-1 PubPrn.vbs Signed Script Bypass

Done executing cleanup for test:
T1216.001-1 PubPrn.vbs Signed Script Bypass

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1006-1 Read volume boot sector via DOS device path (PowerShell)

Done executing cleanup for test:
T1006-1 Read volume boot sector via DOS device path (PowerShell)

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1006-1 Read volume boot sector via DOS device path (PowerShell)

No Preqs Defined


T1006-1
**********************
Windows PowerShell 脚本开始
开始时间: 20230415163519
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 12196 的进程。”
Stop-Process : 找不到进程标识符为 12196 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12196:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 12196 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12196:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 12196 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12196:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1006-1 Read volume boot sector via DOS device path (PowerShell)

Done executing cleanup for test:
T1006-1 Read volume boot sector via DOS device path (PowerShell)

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-1 Bypass UAC using Event Viewer (cmd)

Done executing cleanup for test:
T1548.002-1 Bypass UAC using Event Viewer (cmd)

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1548.002-1 Bypass UAC using Event Viewer (cmd)

No Preqs Defined


T1548.002-1
**********************
Windows PowerShell 脚本开始
开始时间: 20230415163608
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 8232 的进程。”
Stop-Process : 找不到进程标识符为 8232 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8232:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 8232 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8232:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 8232 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8232:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-1 Bypass UAC using Event Viewer (cmd)

Done executing cleanup for test:
T1548.002-1 Bypass UAC using Event Viewer (cmd)

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-2 Bypass UAC using Event Viewer (PowerShell)

Done executing cleanup for test:
T1548.002-2 Bypass UAC using Event Viewer (PowerShell)

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1548.002-2 Bypass UAC using Event Viewer (PowerShell)

No Preqs Defined


T1548.002-2
**********************
Windows PowerShell 脚本开始
开始时间: 20230415163657
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 9176 的进程。”
Stop-Process : 找不到进程标识符为 9176 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9176:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 9176 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9176:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 9176 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9176:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-2 Bypass UAC using Event Viewer (PowerShell)

Done executing cleanup for test:
T1548.002-2 Bypass UAC using Event Viewer (PowerShell)

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-3 Bypass UAC using Fodhelper

Done executing cleanup for test:
T1548.002-3 Bypass UAC using Fodhelper

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1548.002-3 Bypass UAC using Fodhelper

No Preqs Defined


T1548.002-3
**********************
Windows PowerShell 脚本开始
开始时间: 20230415163747
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 13424 的进程。”
Stop-Process : 找不到进程标识符为 13424 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13424:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13424 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13424:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13424 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13424:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-3 Bypass UAC using Fodhelper

Done executing cleanup for test:
T1548.002-3 Bypass UAC using Fodhelper

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-4 Bypass UAC using Fodhelper - PowerShell

Done executing cleanup for test:
T1548.002-4 Bypass UAC using Fodhelper - PowerShell

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1548.002-4 Bypass UAC using Fodhelper - PowerShell

No Preqs Defined


T1548.002-4
**********************
Windows PowerShell 脚本开始
开始时间: 20230415163836
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 12732 的进程。”
Stop-Process : 找不到进程标识符为 12732 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12732:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 12732 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12732:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 12732 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12732:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-4 Bypass UAC using Fodhelper - PowerShell

Done executing cleanup for test:
T1548.002-4 Bypass UAC using Fodhelper - PowerShell

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-5 Bypass UAC using ComputerDefaults (PowerShell)

Done executing cleanup for test:
T1548.002-5 Bypass UAC using ComputerDefaults (PowerShell)

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1548.002-5 Bypass UAC using ComputerDefaults (PowerShell)

No Preqs Defined


T1548.002-5
**********************
Windows PowerShell 脚本开始
开始时间: 20230415163927
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 10568 的进程。”
Stop-Process : 找不到进程标识符为 10568 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10568:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 10568 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10568:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 10568 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10568:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-5 Bypass UAC using ComputerDefaults (PowerShell)

Done executing cleanup for test:
T1548.002-5 Bypass UAC using ComputerDefaults (PowerShell)

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-6 Bypass UAC by Mocking Trusted Directories

Done executing cleanup for test:
T1548.002-6 Bypass UAC by Mocking Trusted Directories

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1548.002-6 Bypass UAC by Mocking Trusted Directories

No Preqs Defined


T1548.002-6
**********************
Windows PowerShell 脚本开始
开始时间: 20230415164017
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 13968 的进程。”
Stop-Process : 找不到进程标识符为 13968 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13968:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13968 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13968:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13968 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13968:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-6 Bypass UAC by Mocking Trusted Directories

Done executing cleanup for test:
T1548.002-6 Bypass UAC by Mocking Trusted Directories

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-7 Bypass UAC using sdclt DelegateExecute

Done executing cleanup for test:
T1548.002-7 Bypass UAC using sdclt DelegateExecute

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1548.002-7 Bypass UAC using sdclt DelegateExecute

No Preqs Defined


T1548.002-7
**********************
Windows PowerShell 脚本开始
开始时间: 20230415164106
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 9180 的进程。”
Stop-Process : 找不到进程标识符为 9180 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9180:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 9180 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9180:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 9180 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9180:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-7 Bypass UAC using sdclt DelegateExecute

Done executing cleanup for test:
T1548.002-7 Bypass UAC using sdclt DelegateExecute

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-8 Disable UAC using reg.exe

操作成功完成。
Done executing cleanup for test:
T1548.002-8 Disable UAC using reg.exe

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1548.002-8 Disable UAC using reg.exe

No Preqs Defined


T1548.002-8
**********************
Windows PowerShell 脚本开始
开始时间: 20230415164155
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 14052 的进程。”
Stop-Process : 找不到进程标识符为 14052 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (14052:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 14052 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (14052:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 14052 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (14052:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-8 Disable UAC using reg.exe

操作成功完成。
Done executing cleanup for test:
T1548.002-8 Disable UAC using reg.exe

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-9 Bypass UAC using SilentCleanup task

Done executing cleanup for test:
T1548.002-9 Bypass UAC using SilentCleanup task

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1548.002-9 Bypass UAC using SilentCleanup task

No Preqs Defined


T1548.002-9
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-9 Bypass UAC using SilentCleanup task

Done executing cleanup for test:
T1548.002-9 Bypass UAC using SilentCleanup task

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-10 UACME Bypass Method 23

Done executing cleanup for test:
T1548.002-10 UACME Bypass Method 23

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1548.002-10 UACME Bypass Method 23

Attempting to satisfy prereq:
UACME executable must exist on disk at specified location (%temp%\uacme\23 Akagi64.exe)

Prereq successfully met:
UACME executable must exist on disk at specified location (%temp%\uacme\23 Akagi64.exe)

T1548.002-10
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-10 UACME Bypass Method 23

Done executing cleanup for test:
T1548.002-10 UACME Bypass Method 23

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-11 UACME Bypass Method 31

Done executing cleanup for test:
T1548.002-11 UACME Bypass Method 31

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1548.002-11 UACME Bypass Method 31

Attempting to satisfy prereq:
UACME executable must exist on disk at specified location (%temp%\uacme\31 Akagi64.exe)

Prereq already met:
UACME executable must exist on disk at specified location (%temp%\uacme\31 Akagi64.exe)

T1548.002-11
**********************
Windows PowerShell 脚本开始
开始时间: 20230415164549
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 14184 的进程。”
Stop-Process : 找不到进程标识符为 14184 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (14184:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 14184 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (14184:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 14184 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (14184:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-11 UACME Bypass Method 31

Done executing cleanup for test:
T1548.002-11 UACME Bypass Method 31

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-12 UACME Bypass Method 33

Done executing cleanup for test:
T1548.002-12 UACME Bypass Method 33

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1548.002-12 UACME Bypass Method 33

Attempting to satisfy prereq:
UACME executable must exist on disk at specified location (%temp%\uacme\33 Akagi64.exe)

Prereq successfully met:
UACME executable must exist on disk at specified location (%temp%\uacme\33 Akagi64.exe)

T1548.002-12
**********************
Windows PowerShell 脚本开始
开始时间: 20230415164653
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 10044 的进程。”
Stop-Process : 找不到进程标识符为 10044 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10044:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 10044 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10044:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 10044 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10044:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-12 UACME Bypass Method 33

Done executing cleanup for test:
T1548.002-12 UACME Bypass Method 33

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-13 UACME Bypass Method 34

Done executing cleanup for test:
T1548.002-13 UACME Bypass Method 34

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1548.002-13 UACME Bypass Method 34

Attempting to satisfy prereq:
UACME executable must exist on disk at specified location (%temp%\uacme\34 Akagi64.exe)

Prereq successfully met:
UACME executable must exist on disk at specified location (%temp%\uacme\34 Akagi64.exe)

T1548.002-13
**********************
Windows PowerShell 脚本开始
开始时间: 20230415164756
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 9784 的进程。”
Stop-Process : 找不到进程标识符为 9784 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9784:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 9784 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9784:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 9784 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9784:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-13 UACME Bypass Method 34

Done executing cleanup for test:
T1548.002-13 UACME Bypass Method 34

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-14 UACME Bypass Method 39

Done executing cleanup for test:
T1548.002-14 UACME Bypass Method 39

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1548.002-14 UACME Bypass Method 39

Attempting to satisfy prereq:
UACME executable must exist on disk at specified location (%temp%\uacme\39 Akagi64.exe)

Invoke-WebRequest : 无法连接到远程服务器
所在位置 行:1 字符: 4
+ & {Invoke-WebRequest "https://github.com/redcanaryco/atomic-red-team/ ...
+    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
    + CategoryInfo          : InvalidOperation: (System.Net.HttpWebRequest:HttpWebRequest) [Invoke-WebRequest]，WebExce
    ption
    + FullyQualifiedErrorId : WebCmdletWebResponseException,Microsoft.PowerShell.Commands.InvokeWebRequestCommand
Expand-Archive : 路径“C:\Users\wangjian\AppData\Local\Temp\uacme.zip”不存在，或者不是有效的文件系统路径。
所在位置 行:2 字符: 1
+ Expand-Archive $env:TEMP\uacme.zip $env:TEMP\uacme -Force
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (C:\Users\wangji...\Temp\uacme.zip:String) [Expand-Archive]，InvalidOper
    ationException
    + FullyQualifiedErrorId : ArchiveCmdletPathNotFound,Expand-Archive
 
Remove-Item : 找不到路径“C:\Users\wangjian\AppData\Local\Temp\uacme.zip”，因为该路径不存在。
所在位置 行:3 字符: 1
+ Remove-Item $env:TEMP\uacme.zip -Force}
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (C:\Users\wangji...\Temp\uacme.zip:String) [Remove-Item], ItemNotFoundEx 
   ception
    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.RemoveItemCommand
Failed to meet prereq: UACME executable must exist on disk at specified location (%temp%\uacme\39 Akagi64.exe)
T1548.002-14
**********************
Windows PowerShell 脚本开始
开始时间: 20230415164915
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 12528 的进程。”
Stop-Process : 找不到进程标识符为 12528 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12528:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 12528 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12528:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 12528 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12528:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-14 UACME Bypass Method 39

Done executing cleanup for test:
T1548.002-14 UACME Bypass Method 39

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-15 UACME Bypass Method 56

Done executing cleanup for test:
T1548.002-15 UACME Bypass Method 56

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1548.002-15 UACME Bypass Method 56

Attempting to satisfy prereq:
UACME executable must exist on disk at specified location (%temp%\uacme\56 Akagi64.exe)

Prereq successfully met:
UACME executable must exist on disk at specified location (%temp%\uacme\56 Akagi64.exe)

T1548.002-15
**********************
Windows PowerShell 脚本开始
开始时间: 20230415165021
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 1148 的进程。”
Stop-Process : 找不到进程标识符为 1148 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (1148:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 1148 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (1148:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 1148 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (1148:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-15 UACME Bypass Method 56

Done executing cleanup for test:
T1548.002-15 UACME Bypass Method 56

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-16 UACME Bypass Method 59

Done executing cleanup for test:
T1548.002-16 UACME Bypass Method 59

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1548.002-16 UACME Bypass Method 59

Attempting to satisfy prereq:
UACME executable must exist on disk at specified location (%temp%\uacme\59 Akagi64.exe)

Prereq successfully met:
UACME executable must exist on disk at specified location (%temp%\uacme\59 Akagi64.exe)

T1548.002-16
**********************
Windows PowerShell 脚本开始
开始时间: 20230415165127
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 10804 的进程。”
Stop-Process : 找不到进程标识符为 10804 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10804:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 10804 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10804:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 10804 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10804:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-16 UACME Bypass Method 59

Done executing cleanup for test:
T1548.002-16 UACME Bypass Method 59

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-17 UACME Bypass Method 61

Done executing cleanup for test:
T1548.002-17 UACME Bypass Method 61

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1548.002-17 UACME Bypass Method 61

Attempting to satisfy prereq:
UACME executable must exist on disk at specified location (%temp%\uacme\61 Akagi64.exe)

Process Timed out after 120 seconds, use '-TimeoutSeconds' to specify a different timeout
Failed to meet prereq: UACME executable must exist on disk at specified location (%temp%\uacme\61 Akagi64.exe)
T1548.002-17
**********************
Windows PowerShell 脚本开始
开始时间: 20230415165423
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 11636 的进程。”
Stop-Process : 找不到进程标识符为 11636 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (11636:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 11636 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (11636:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 11636 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (11636:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-17 UACME Bypass Method 61

Done executing cleanup for test:
T1548.002-17 UACME Bypass Method 61

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-18 WinPwn - UAC Magic

Done executing cleanup for test:
T1548.002-18 WinPwn - UAC Magic

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1548.002-18 WinPwn - UAC Magic

No Preqs Defined


T1548.002-18
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-18 WinPwn - UAC Magic

Done executing cleanup for test:
T1548.002-18 WinPwn - UAC Magic

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-19 WinPwn - UAC Bypass ccmstp technique

Done executing cleanup for test:
T1548.002-19 WinPwn - UAC Bypass ccmstp technique

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1548.002-19 WinPwn - UAC Bypass ccmstp technique

No Preqs Defined


T1548.002-19
**********************
Windows PowerShell 脚本开始
开始时间: 20230415165603
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 9896 的进程。”
Stop-Process : 找不到进程标识符为 9896 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9896:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 9896 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9896:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 9896 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9896:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-19 WinPwn - UAC Bypass ccmstp technique

Done executing cleanup for test:
T1548.002-19 WinPwn - UAC Bypass ccmstp technique

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-20 WinPwn - UAC Bypass DiskCleanup technique

Done executing cleanup for test:
T1548.002-20 WinPwn - UAC Bypass DiskCleanup technique

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1548.002-20 WinPwn - UAC Bypass DiskCleanup technique

No Preqs Defined


T1548.002-20
**********************
Windows PowerShell 脚本开始
开始时间: 20230415165654
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 12216 的进程。”
Stop-Process : 找不到进程标识符为 12216 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12216:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 12216 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12216:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 12216 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12216:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-20 WinPwn - UAC Bypass DiskCleanup technique

Done executing cleanup for test:
T1548.002-20 WinPwn - UAC Bypass DiskCleanup technique

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-21 WinPwn - UAC Bypass DccwBypassUAC technique

Done executing cleanup for test:
T1548.002-21 WinPwn - UAC Bypass DccwBypassUAC technique

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1548.002-21 WinPwn - UAC Bypass DccwBypassUAC technique

No Preqs Defined


T1548.002-21
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-21 WinPwn - UAC Bypass DccwBypassUAC technique

Done executing cleanup for test:
T1548.002-21 WinPwn - UAC Bypass DccwBypassUAC technique

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-22 Disable UAC admin consent prompt via ConsentPromptBehaviorAdmin registry key

Done executing cleanup for test:
T1548.002-22 Disable UAC admin consent prompt via ConsentPromptBehaviorAdmin registry key

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1548.002-22 Disable UAC admin consent prompt via ConsentPromptBehaviorAdmin registry key

No Preqs Defined


T1548.002-22
**********************
Windows PowerShell 脚本开始
开始时间: 20230415165835
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 3556 的进程。”
Stop-Process : 找不到进程标识符为 3556 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (3556:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 3556 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (3556:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 3556 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (3556:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1548.002-22 Disable UAC admin consent prompt via ConsentPromptBehaviorAdmin registry key

Done executing cleanup for test:
T1548.002-22 Disable UAC admin consent prompt via ConsentPromptBehaviorAdmin registry key

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1574.011-1 Service Registry Permissions Weakness

Done executing cleanup for test:
T1574.011-1 Service Registry Permissions Weakness

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1574.011-1 Service Registry Permissions Weakness

No Preqs Defined


T1574.011-1
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1574.011-1 Service Registry Permissions Weakness

Done executing cleanup for test:
T1574.011-1 Service Registry Permissions Weakness

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1574.011-2 Service ImagePath Change with reg.exe

[SC] OpenService 失败 1060:
指定的服务未安装。
Done executing cleanup for test:
T1574.011-2 Service ImagePath Change with reg.exe

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1574.011-2 Service ImagePath Change with reg.exe

Attempting to satisfy prereq:
The service must exist (calcservice)

[SC] CreateService 成功
Prereq successfully met:
The service must exist (calcservice)

T1574.011-2
**********************
Windows PowerShell 脚本开始
开始时间: 20230415170017
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 12256 的进程。”
Stop-Process : 找不到进程标识符为 12256 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12256:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 12256 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12256:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 12256 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12256:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1574.011-2 Service ImagePath Change with reg.exe

[SC] DeleteService 成功
Done executing cleanup for test:
T1574.011-2 Service ImagePath Change with reg.exe

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1036.005-2 Masquerade as a built-in system executable

Done executing cleanup for test:
T1036.005-2 Masquerade as a built-in system executable

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1036.005-2 Masquerade as a built-in system executable

No Preqs Defined


T1036.005-2
**********************
Windows PowerShell 脚本开始
开始时间: 20230415170105
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 13872 的进程。”
Stop-Process : 找不到进程标识符为 13872 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13872:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13872 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13872:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13872 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13872:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1036.005-2 Masquerade as a built-in system executable

Done executing cleanup for test:
T1036.005-2 Masquerade as a built-in system executable

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1564-1 Extract binary files via VBA

Done executing cleanup for test:
T1564-1 Extract binary files via VBA

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1564-1 Extract binary files via VBA

Attempting to satisfy prereq:
Microsoft Word must be installed

You will need to install Microsoft Word manually to meet this requirement
Failed to meet prereq: Microsoft Word must be installed
T1564-1
**********************
Windows PowerShell 脚本开始
开始时间: 20230415170200
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 12136 的进程。”
Stop-Process : 找不到进程标识符为 12136 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12136:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 12136 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12136:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 12136 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12136:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1564-1 Extract binary files via VBA

Done executing cleanup for test:
T1564-1 Extract binary files via VBA

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1564-2 Create a Hidden User Called "$"

找不到用户名。
请键入 NET HELPMSG 2221 以获得更多的帮助。
Done executing cleanup for test:
T1564-2 Create a Hidden User Called "$"

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1564-2 Create a Hidden User Called "$"

No Preqs Defined


T1564-2
**********************
Windows PowerShell 脚本开始
开始时间: 20230415170248
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 14268 的进程。”
Stop-Process : 找不到进程标识符为 14268 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (14268:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 14268 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (14268:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 14268 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (14268:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1564-2 Create a Hidden User Called "$"

命令成功完成。
Done executing cleanup for test:
T1564-2 Create a Hidden User Called "$"

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1564-3 Create an "Administrator " user (with a space on the end)

Done executing cleanup for test:
T1564-3 Create an "Administrator " user (with a space on the end)

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1564-3 Create an "Administrator " user (with a space on the end)

No Preqs Defined


T1564-3
**********************
Windows PowerShell 脚本开始
开始时间: 20230415170336
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 14024 的进程。”
Stop-Process : 找不到进程标识符为 14024 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (14024:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 14024 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (14024:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 14024 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (14024:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1564-3 Create an "Administrator " user (with a space on the end)

Done executing cleanup for test:
T1564-3 Create an "Administrator " user (with a space on the end)

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1497.001-2 Detect Virtualization Environment (Windows)

Done executing cleanup for test:
T1497.001-2 Detect Virtualization Environment (Windows)

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1497.001-2 Detect Virtualization Environment (Windows)

No Preqs Defined


T1497.001-2
**********************
Windows PowerShell 脚本开始
开始时间: 20230415170425
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 8412 的进程。”
Stop-Process : 找不到进程标识符为 8412 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8412:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 8412 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8412:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 8412 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8412:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1497.001-2 Detect Virtualization Environment (Windows)

Done executing cleanup for test:
T1497.001-2 Detect Virtualization Environment (Windows)

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1497.001-4 Detect Virtualization Environment via WMI Manufacturer/Model Listing (Windows)

Done executing cleanup for test:
T1497.001-4 Detect Virtualization Environment via WMI Manufacturer/Model Listing (Windows)

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1497.001-4 Detect Virtualization Environment via WMI Manufacturer/Model Listing (Windows)

No Preqs Defined


T1497.001-4
**********************
Windows PowerShell 脚本开始
开始时间: 20230415170515
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 14008 的进程。”
Stop-Process : 找不到进程标识符为 14008 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (14008:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 14008 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (14008:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 14008 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (14008:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1497.001-4 Detect Virtualization Environment via WMI Manufacturer/Model Listing (Windows)

Done executing cleanup for test:
T1497.001-4 Detect Virtualization Environment via WMI Manufacturer/Model Listing (Windows)

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.004-1 CheckIfInstallable method call

Done executing cleanup for test:
T1218.004-1 CheckIfInstallable method call

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.004-1 CheckIfInstallable method call

Attempting to satisfy prereq:
InstallUtil test harness script must be installed at specified location (C:\AtomicRedTeam\atomics\T1218.004\src\InstallUtilTestHarness.ps1)

Prereq already met:
InstallUtil test harness script must be installed at specified location (C:\AtomicRedTeam\atomics\T1218.004\src\InstallUtilTestHarness.ps1)

T1218.004-1
**********************
Windows PowerShell 脚本开始
开始时间: 20230415170607
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 10704 的进程。”
Stop-Process : 找不到进程标识符为 10704 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10704:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 10704 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10704:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 10704 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10704:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.004-1 CheckIfInstallable method call

Done executing cleanup for test:
T1218.004-1 CheckIfInstallable method call

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.004-2 InstallHelper method call

Done executing cleanup for test:
T1218.004-2 InstallHelper method call

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.004-2 InstallHelper method call

Attempting to satisfy prereq:
InstallUtil test harness script must be installed at specified location (C:\AtomicRedTeam\atomics\T1218.004\src\InstallUtilTestHarness.ps1)

Prereq already met:
InstallUtil test harness script must be installed at specified location (C:\AtomicRedTeam\atomics\T1218.004\src\InstallUtilTestHarness.ps1)

T1218.004-2
**********************
Windows PowerShell 脚本开始
开始时间: 20230415170659
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 3316 的进程。”
Stop-Process : 找不到进程标识符为 3316 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (3316:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 3316 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (3316:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 3316 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (3316:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.004-2 InstallHelper method call

Done executing cleanup for test:
T1218.004-2 InstallHelper method call

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.004-3 InstallUtil class constructor method call

Done executing cleanup for test:
T1218.004-3 InstallUtil class constructor method call

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.004-3 InstallUtil class constructor method call

Attempting to satisfy prereq:
InstallUtil test harness script must be installed at specified location (C:\AtomicRedTeam\atomics\T1218.004\src\InstallUtilTestHarness.ps1)

Prereq already met:
InstallUtil test harness script must be installed at specified location (C:\AtomicRedTeam\atomics\T1218.004\src\InstallUtilTestHarness.ps1)

T1218.004-3
**********************
Windows PowerShell 脚本开始
开始时间: 20230415170751
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 12356 的进程。”
Stop-Process : 找不到进程标识符为 12356 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12356:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 12356 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12356:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 12356 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12356:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.004-3 InstallUtil class constructor method call

Done executing cleanup for test:
T1218.004-3 InstallUtil class constructor method call

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.004-4 InstallUtil Install method call

Done executing cleanup for test:
T1218.004-4 InstallUtil Install method call

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.004-4 InstallUtil Install method call

Attempting to satisfy prereq:
InstallUtil test harness script must be installed at specified location (C:\AtomicRedTeam\atomics\T1218.004\src\InstallUtilTestHarness.ps1)

Prereq already met:
InstallUtil test harness script must be installed at specified location (C:\AtomicRedTeam\atomics\T1218.004\src\InstallUtilTestHarness.ps1)

T1218.004-4
**********************
Windows PowerShell 脚本开始
开始时间: 20230415170844
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 13072 的进程。”
Stop-Process : 找不到进程标识符为 13072 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13072:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13072 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13072:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13072 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13072:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.004-4 InstallUtil Install method call

Done executing cleanup for test:
T1218.004-4 InstallUtil Install method call

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.004-5 InstallUtil Uninstall method call - /U variant

Done executing cleanup for test:
T1218.004-5 InstallUtil Uninstall method call - /U variant

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.004-5 InstallUtil Uninstall method call - /U variant

Attempting to satisfy prereq:
InstallUtil test harness script must be installed at specified location (C:\AtomicRedTeam\atomics\T1218.004\src\InstallUtilTestHarness.ps1)

Prereq already met:
InstallUtil test harness script must be installed at specified location (C:\AtomicRedTeam\atomics\T1218.004\src\InstallUtilTestHarness.ps1)

T1218.004-5
**********************
Windows PowerShell 脚本开始
开始时间: 20230415170936
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 6224 的进程。”
Stop-Process : 找不到进程标识符为 6224 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (6224:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 6224 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (6224:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 6224 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (6224:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.004-5 InstallUtil Uninstall method call - /U variant

Done executing cleanup for test:
T1218.004-5 InstallUtil Uninstall method call - /U variant

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.004-6 InstallUtil Uninstall method call - '/installtype=notransaction /action=uninstall' variant

Done executing cleanup for test:
T1218.004-6 InstallUtil Uninstall method call - '/installtype=notransaction /action=uninstall' variant

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.004-6 InstallUtil Uninstall method call - '/installtype=notransaction /action=uninstall' variant

Attempting to satisfy prereq:
InstallUtil test harness script must be installed at specified location (C:\AtomicRedTeam\atomics\T1218.004\src\InstallUtilTestHarness.ps1)

Prereq already met:
InstallUtil test harness script must be installed at specified location (C:\AtomicRedTeam\atomics\T1218.004\src\InstallUtilTestHarness.ps1)

T1218.004-6
**********************
Windows PowerShell 脚本开始
开始时间: 20230415171028
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 8032 的进程。”
Stop-Process : 找不到进程标识符为 8032 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8032:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 8032 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8032:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 8032 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8032:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.004-6 InstallUtil Uninstall method call - '/installtype=notransaction /action=uninstall' variant

Done executing cleanup for test:
T1218.004-6 InstallUtil Uninstall method call - '/installtype=notransaction /action=uninstall' variant

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.004-7 InstallUtil HelpText method call

Done executing cleanup for test:
T1218.004-7 InstallUtil HelpText method call

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.004-7 InstallUtil HelpText method call

Attempting to satisfy prereq:
InstallUtil test harness script must be installed at specified location (C:\AtomicRedTeam\atomics\T1218.004\src\InstallUtilTestHarness.ps1)

Prereq already met:
InstallUtil test harness script must be installed at specified location (C:\AtomicRedTeam\atomics\T1218.004\src\InstallUtilTestHarness.ps1)

T1218.004-7
**********************
Windows PowerShell 脚本开始
开始时间: 20230415171120
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 10600 的进程。”
Stop-Process : 找不到进程标识符为 10600 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10600:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 10600 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10600:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 10600 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10600:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.004-7 InstallUtil HelpText method call

Done executing cleanup for test:
T1218.004-7 InstallUtil HelpText method call

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.004-8 InstallUtil evasive invocation

Done executing cleanup for test:
T1218.004-8 InstallUtil evasive invocation

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.004-8 InstallUtil evasive invocation

Attempting to satisfy prereq:
InstallUtil test harness script must be installed at specified location (C:\AtomicRedTeam\atomics\T1218.004\src\InstallUtilTestHarness.ps1)

Prereq already met:
InstallUtil test harness script must be installed at specified location (C:\AtomicRedTeam\atomics\T1218.004\src\InstallUtilTestHarness.ps1)

T1218.004-8
**********************
Windows PowerShell 脚本开始
开始时间: 20230415171213
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 14100 的进程。”
Stop-Process : 找不到进程标识符为 14100 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (14100:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 14100 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (14100:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 14100 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (14100:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.004-8 InstallUtil evasive invocation

Done executing cleanup for test:
T1218.004-8 InstallUtil evasive invocation

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1574.001-1 DLL Search Order Hijacking - amsi.dll

Done executing cleanup for test:
T1574.001-1 DLL Search Order Hijacking - amsi.dll

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1574.001-1 DLL Search Order Hijacking - amsi.dll

No Preqs Defined


T1574.001-1
**********************
Windows PowerShell 脚本开始
开始时间: 20230415171300
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 14332 的进程。”
Stop-Process : 找不到进程标识符为 14332 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (14332:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 14332 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (14332:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 14332 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (14332:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1574.001-1 DLL Search Order Hijacking - amsi.dll

Done executing cleanup for test:
T1574.001-1 DLL Search Order Hijacking - amsi.dll

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1222.001-1 Take ownership using takeown utility

Done executing cleanup for test:
T1222.001-1 Take ownership using takeown utility

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1222.001-1 Take ownership using takeown utility

Attempting to satisfy prereq:
Test requrires a file to take ownership of to be located at (%temp%\T1222.001_takeown_folder)

Prereq successfully met:
Test requrires a file to take ownership of to be located at (%temp%\T1222.001_takeown_folder)

T1222.001-1
**********************
Windows PowerShell 脚本开始
开始时间: 20230415171347
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 9844 的进程。”
Stop-Process : 找不到进程标识符为 9844 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9844:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 9844 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9844:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 9844 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9844:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1222.001-1 Take ownership using takeown utility

Done executing cleanup for test:
T1222.001-1 Take ownership using takeown utility

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1222.001-2 cacls - Grant permission to specified user or group recursively

Done executing cleanup for test:
T1222.001-2 cacls - Grant permission to specified user or group recursively

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1222.001-2 cacls - Grant permission to specified user or group recursively

Attempting to satisfy prereq:
Test requrires a file to modify to be located at (%temp%\T1222.001_cacls)

Prereq successfully met:
Test requrires a file to modify to be located at (%temp%\T1222.001_cacls)

T1222.001-2
**********************
Windows PowerShell 脚本开始
开始时间: 20230415171434
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 13340 的进程。”
Stop-Process : 找不到进程标识符为 13340 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13340:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13340 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13340:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13340 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13340:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1222.001-2 cacls - Grant permission to specified user or group recursively

Done executing cleanup for test:
T1222.001-2 cacls - Grant permission to specified user or group recursively

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1222.001-3 attrib - Remove read-only attribute

Done executing cleanup for test:
T1222.001-3 attrib - Remove read-only attribute

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1222.001-3 attrib - Remove read-only attribute

Attempting to satisfy prereq:
Test requrires a file to modify to be located at (%temp%\T1222.001_attrib)

Prereq successfully met:
Test requrires a file to modify to be located at (%temp%\T1222.001_attrib)

T1222.001-3
**********************
Windows PowerShell 脚本开始
开始时间: 20230415171520
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 10100 的进程。”
Stop-Process : 找不到进程标识符为 10100 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10100:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 10100 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10100:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 10100 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10100:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1222.001-3 attrib - Remove read-only attribute

Done executing cleanup for test:
T1222.001-3 attrib - Remove read-only attribute

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1222.001-4 attrib - hide file

Done executing cleanup for test:
T1222.001-4 attrib - hide file

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1222.001-4 attrib - hide file

No Preqs Defined


T1222.001-4
**********************
Windows PowerShell 脚本开始
开始时间: 20230415171607
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 13608 的进程。”
Stop-Process : 找不到进程标识符为 13608 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13608:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13608 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13608:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13608 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13608:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1222.001-4 attrib - hide file

Done executing cleanup for test:
T1222.001-4 attrib - hide file

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1222.001-5 Grant Full Access to folder for Everyone - Ryuk Ransomware Style

Done executing cleanup for test:
T1222.001-5 Grant Full Access to folder for Everyone - Ryuk Ransomware Style

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1222.001-5 Grant Full Access to folder for Everyone - Ryuk Ransomware Style

Attempting to satisfy prereq:
Backup of original folder permissions should exist (for use in cleanup commands)

Prereq successfully met:
Backup of original folder permissions should exist (for use in cleanup commands)

T1222.001-5
**********************
Windows PowerShell 脚本开始
开始时间: 20230415171653
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 7020 的进程。”
Stop-Process : 找不到进程标识符为 7020 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (7020:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 7020 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (7020:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 7020 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (7020:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1222.001-5 Grant Full Access to folder for Everyone - Ryuk Ransomware Style

Done executing cleanup for test:
T1222.001-5 Grant Full Access to folder for Everyone - Ryuk Ransomware Style

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.007-1 Msiexec.exe - Execute Local MSI file with embedded JScript

Done executing cleanup for test:
T1218.007-1 Msiexec.exe - Execute Local MSI file with embedded JScript

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.007-1 Msiexec.exe - Execute Local MSI file with embedded JScript

Attempting to satisfy prereq:
The MSI file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.007\bin\T1218.007_JScript.msi)

Prereq already met:
The MSI file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.007\bin\T1218.007_JScript.msi)

T1218.007-1
**********************
Windows PowerShell 脚本开始
开始时间: 20230415171742
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 6024 的进程。”
Stop-Process : 找不到进程标识符为 6024 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (6024:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 6024 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (6024:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 6024 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (6024:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.007-1 Msiexec.exe - Execute Local MSI file with embedded JScript

Done executing cleanup for test:
T1218.007-1 Msiexec.exe - Execute Local MSI file with embedded JScript

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.007-2 Msiexec.exe - Execute Local MSI file with embedded VBScript

Done executing cleanup for test:
T1218.007-2 Msiexec.exe - Execute Local MSI file with embedded VBScript

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.007-2 Msiexec.exe - Execute Local MSI file with embedded VBScript

Attempting to satisfy prereq:
The MSI file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.007\bin\T1218.007_VBScript.msi)

Prereq already met:
The MSI file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.007\bin\T1218.007_VBScript.msi)

T1218.007-2
**********************
Windows PowerShell 脚本开始
开始时间: 20230415171832
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 8284 的进程。”
Stop-Process : 找不到进程标识符为 8284 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8284:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 8284 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8284:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 8284 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8284:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.007-2 Msiexec.exe - Execute Local MSI file with embedded VBScript

Done executing cleanup for test:
T1218.007-2 Msiexec.exe - Execute Local MSI file with embedded VBScript

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.007-3 Msiexec.exe - Execute Local MSI file with an embedded DLL

Done executing cleanup for test:
T1218.007-3 Msiexec.exe - Execute Local MSI file with an embedded DLL

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.007-3 Msiexec.exe - Execute Local MSI file with an embedded DLL

Attempting to satisfy prereq:
The MSI file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.007\bin\T1218.007_DLL.msi)

Prereq already met:
The MSI file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.007\bin\T1218.007_DLL.msi)

T1218.007-3
**********************
Windows PowerShell 脚本开始
开始时间: 20230415171921
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 13172 的进程。”
Stop-Process : 找不到进程标识符为 13172 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13172:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13172 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13172:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13172 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13172:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.007-3 Msiexec.exe - Execute Local MSI file with an embedded DLL

Done executing cleanup for test:
T1218.007-3 Msiexec.exe - Execute Local MSI file with an embedded DLL

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.007-4 Msiexec.exe - Execute Local MSI file with an embedded EXE

Done executing cleanup for test:
T1218.007-4 Msiexec.exe - Execute Local MSI file with an embedded EXE

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.007-4 Msiexec.exe - Execute Local MSI file with an embedded EXE

Attempting to satisfy prereq:
The MSI file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.007\bin\T1218.007_EXE.msi)

Prereq already met:
The MSI file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.007\bin\T1218.007_EXE.msi)

T1218.007-4
**********************
Windows PowerShell 脚本开始
开始时间: 20230415172010
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 7052 的进程。”
Stop-Process : 找不到进程标识符为 7052 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (7052:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 7052 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (7052:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 7052 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (7052:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.007-4 Msiexec.exe - Execute Local MSI file with an embedded EXE

Done executing cleanup for test:
T1218.007-4 Msiexec.exe - Execute Local MSI file with an embedded EXE

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.007-5 WMI Win32_Product Class - Execute Local MSI file with embedded JScript

Done executing cleanup for test:
T1218.007-5 WMI Win32_Product Class - Execute Local MSI file with embedded JScript

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.007-5 WMI Win32_Product Class - Execute Local MSI file with embedded JScript

Attempting to satisfy prereq:
The MSI file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.007\bin\T1218.007_JScript.msi)

Prereq already met:
The MSI file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.007\bin\T1218.007_JScript.msi)

T1218.007-5
**********************
Windows PowerShell 脚本开始
开始时间: 20230415172101
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 12936 的进程。”
Stop-Process : 找不到进程标识符为 12936 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12936:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 12936 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12936:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 12936 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12936:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.007-5 WMI Win32_Product Class - Execute Local MSI file with embedded JScript

Done executing cleanup for test:
T1218.007-5 WMI Win32_Product Class - Execute Local MSI file with embedded JScript

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.007-6 WMI Win32_Product Class - Execute Local MSI file with embedded VBScript

Done executing cleanup for test:
T1218.007-6 WMI Win32_Product Class - Execute Local MSI file with embedded VBScript

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.007-6 WMI Win32_Product Class - Execute Local MSI file with embedded VBScript

Attempting to satisfy prereq:
The MSI file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.007\bin\T1218.007_VBScript.msi)

Prereq already met:
The MSI file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.007\bin\T1218.007_VBScript.msi)

T1218.007-6
**********************
Windows PowerShell 脚本开始
开始时间: 20230415172154
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 8236 的进程。”
Stop-Process : 找不到进程标识符为 8236 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8236:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 8236 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8236:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 8236 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8236:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.007-6 WMI Win32_Product Class - Execute Local MSI file with embedded VBScript

Done executing cleanup for test:
T1218.007-6 WMI Win32_Product Class - Execute Local MSI file with embedded VBScript

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.007-7 WMI Win32_Product Class - Execute Local MSI file with an embedded DLL

Done executing cleanup for test:
T1218.007-7 WMI Win32_Product Class - Execute Local MSI file with an embedded DLL

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.007-7 WMI Win32_Product Class - Execute Local MSI file with an embedded DLL

Attempting to satisfy prereq:
The MSI file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.007\bin\T1218.007_DLL.msi)

Prereq already met:
The MSI file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.007\bin\T1218.007_DLL.msi)

T1218.007-7
**********************
Windows PowerShell 脚本开始
开始时间: 20230415172246
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 6580 的进程。”
Stop-Process : 找不到进程标识符为 6580 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (6580:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 6580 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (6580:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 6580 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (6580:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.007-7 WMI Win32_Product Class - Execute Local MSI file with an embedded DLL

Done executing cleanup for test:
T1218.007-7 WMI Win32_Product Class - Execute Local MSI file with an embedded DLL

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.007-8 WMI Win32_Product Class - Execute Local MSI file with an embedded EXE

Done executing cleanup for test:
T1218.007-8 WMI Win32_Product Class - Execute Local MSI file with an embedded EXE

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.007-8 WMI Win32_Product Class - Execute Local MSI file with an embedded EXE

Attempting to satisfy prereq:
The MSI file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.007\bin\T1218.007_EXE.msi)

Prereq already met:
The MSI file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.007\bin\T1218.007_EXE.msi)

T1218.007-8
**********************
Windows PowerShell 脚本开始
开始时间: 20230415172338
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 9268 的进程。”
Stop-Process : 找不到进程标识符为 9268 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9268:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 9268 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9268:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 9268 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9268:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.007-8 WMI Win32_Product Class - Execute Local MSI file with an embedded EXE

Done executing cleanup for test:
T1218.007-8 WMI Win32_Product Class - Execute Local MSI file with an embedded EXE

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.007-9 Msiexec.exe - Execute the DllRegisterServer function of a DLL

Done executing cleanup for test:
T1218.007-9 Msiexec.exe - Execute the DllRegisterServer function of a DLL

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.007-9 Msiexec.exe - Execute the DllRegisterServer function of a DLL

Attempting to satisfy prereq:
The DLL must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.007\bin\MSIRunner.dll)

Prereq already met:
The DLL must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.007\bin\MSIRunner.dll)

T1218.007-9
**********************
Windows PowerShell 脚本开始
开始时间: 20230415172429
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 5704 的进程。”
Stop-Process : 找不到进程标识符为 5704 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (5704:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 5704 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (5704:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 5704 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (5704:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.007-9 Msiexec.exe - Execute the DllRegisterServer function of a DLL

Done executing cleanup for test:
T1218.007-9 Msiexec.exe - Execute the DllRegisterServer function of a DLL

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.007-10 Msiexec.exe - Execute the DllUnregisterServer function of a DLL

Done executing cleanup for test:
T1218.007-10 Msiexec.exe - Execute the DllUnregisterServer function of a DLL

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.007-10 Msiexec.exe - Execute the DllUnregisterServer function of a DLL

Attempting to satisfy prereq:
The DLL must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.007\bin\MSIRunner.dll)

Prereq already met:
The DLL must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.007\bin\MSIRunner.dll)

T1218.007-10
**********************
Windows PowerShell 脚本开始
开始时间: 20230415172518
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 3112 的进程。”
Stop-Process : 找不到进程标识符为 3112 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (3112:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 3112 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (3112:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 3112 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (3112:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.007-10 Msiexec.exe - Execute the DllUnregisterServer function of a DLL

Done executing cleanup for test:
T1218.007-10 Msiexec.exe - Execute the DllUnregisterServer function of a DLL

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.007-11 Msiexec.exe - Execute Remote MSI file

Done executing cleanup for test:
T1218.007-11 Msiexec.exe - Execute Remote MSI file

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.007-11 Msiexec.exe - Execute Remote MSI file

No Preqs Defined


T1218.007-11
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.007-11 Msiexec.exe - Execute Remote MSI file

Done executing cleanup for test:
T1218.007-11 Msiexec.exe - Execute Remote MSI file

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1556.002-1 Install and Register Password Filter DLL

错误: 访问注册表时出错。
remove-item : 找不到路径“C:\Windows\System32\AtomicRedTeamPWFilter.dll”，因为该路径不存在。
所在位置 行:2 字符: 1
+ remove-item C:\Windows\System32\AtomicRedTeamPWFilter.dll}
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (C:\Windows\Syst...eamPWFilter.dll:String) [Remove-Item], ItemNotFoundEx 
   ception
    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.RemoveItemCommand
Done executing cleanup for test:
T1556.002-1 Install and Register Password Filter DLL

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1556.002-1 Install and Register Password Filter DLL

Attempting to satisfy prereq:
AtomicRedTeamPWFilter.dll must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1556.002\bin\AtomicRedTeamPWFilter.dll)

Prereq already met:
AtomicRedTeamPWFilter.dll must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1556.002\bin\AtomicRedTeamPWFilter.dll)

T1556.002-1
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1556.002-1 Install and Register Password Filter DLL

错误: 访问注册表时出错。
remove-item : 找不到路径“C:\Windows\System32\AtomicRedTeamPWFilter.dll”，因为该路径不存在。
所在位置 行:2 字符: 1
+ remove-item C:\Windows\System32\AtomicRedTeamPWFilter.dll}
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (C:\Windows\Syst...eamPWFilter.dll:String) [Remove-Item], ItemNotFoundEx 
   ception
    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.RemoveItemCommand
Done executing cleanup for test:
T1556.002-1 Install and Register Password Filter DLL

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1070.003-10 Prevent Powershell History Logging

Done executing cleanup for test:
T1070.003-10 Prevent Powershell History Logging

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1070.003-10 Prevent Powershell History Logging

No Preqs Defined


T1070.003-10
**********************
Windows PowerShell 脚本开始
开始时间: 20230415172745
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 2768 的进程。”
Stop-Process : 找不到进程标识符为 2768 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (2768:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 2768 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (2768:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 2768 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (2768:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1070.003-10 Prevent Powershell History Logging

Done executing cleanup for test:
T1070.003-10 Prevent Powershell History Logging

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1070.003-11 Clear Powershell History by Deleting History File

Done executing cleanup for test:
T1070.003-11 Clear Powershell History by Deleting History File

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1070.003-11 Clear Powershell History by Deleting History File

No Preqs Defined


T1070.003-11
**********************
Windows PowerShell 脚本开始
开始时间: 20230415172835
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 4164 的进程。”
Stop-Process : 找不到进程标识符为 4164 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (4164:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 4164 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (4164:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 4164 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (4164:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1070.003-11 Clear Powershell History by Deleting History File

Done executing cleanup for test:
T1070.003-11 Clear Powershell History by Deleting History File

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1070.003-12 Set Custom AddToHistoryHandler to Avoid History File Logging

Done executing cleanup for test:
T1070.003-12 Set Custom AddToHistoryHandler to Avoid History File Logging

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1070.003-12 Set Custom AddToHistoryHandler to Avoid History File Logging

No Preqs Defined


T1070.003-12
**********************
Windows PowerShell 脚本开始
开始时间: 20230415172925
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 13124 的进程。”
Stop-Process : 找不到进程标识符为 13124 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13124:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13124 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13124:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13124 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13124:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1070.003-12 Set Custom AddToHistoryHandler to Avoid History File Logging

Done executing cleanup for test:
T1070.003-12 Set Custom AddToHistoryHandler to Avoid History File Logging

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1202-1 Indirect Command Execution - pcalua.exe

Done executing cleanup for test:
T1202-1 Indirect Command Execution - pcalua.exe

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1202-1 Indirect Command Execution - pcalua.exe

No Preqs Defined


T1202-1
**********************
Windows PowerShell 脚本开始
开始时间: 20230415173012
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 13040 的进程。”
Stop-Process : 找不到进程标识符为 13040 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13040:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13040 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13040:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13040 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13040:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1202-1 Indirect Command Execution - pcalua.exe

Done executing cleanup for test:
T1202-1 Indirect Command Execution - pcalua.exe

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1202-2 Indirect Command Execution - forfiles.exe

Done executing cleanup for test:
T1202-2 Indirect Command Execution - forfiles.exe

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1202-2 Indirect Command Execution - forfiles.exe

No Preqs Defined


T1202-2
**********************
Windows PowerShell 脚本开始
开始时间: 20230415173058
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 8292 的进程。”
Stop-Process : 找不到进程标识符为 8292 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8292:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 8292 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8292:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 8292 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8292:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1202-2 Indirect Command Execution - forfiles.exe

Done executing cleanup for test:
T1202-2 Indirect Command Execution - forfiles.exe

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1202-3 Indirect Command Execution - conhost.exe

Done executing cleanup for test:
T1202-3 Indirect Command Execution - conhost.exe

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1202-3 Indirect Command Execution - conhost.exe

No Preqs Defined


T1202-3
**********************
Windows PowerShell 脚本开始
开始时间: 20230415173145
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 13424 的进程。”
Stop-Process : 找不到进程标识符为 13424 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13424:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13424 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13424:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13424 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13424:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1202-3 Indirect Command Execution - conhost.exe

Done executing cleanup for test:
T1202-3 Indirect Command Execution - conhost.exe

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1140-1 Deobfuscate/Decode Files Or Information

Done executing cleanup for test:
T1140-1 Deobfuscate/Decode Files Or Information

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1140-1 Deobfuscate/Decode Files Or Information

No Preqs Defined


T1140-1
**********************
Windows PowerShell 脚本开始
开始时间: 20230415173231
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 10332 的进程。”
Stop-Process : 找不到进程标识符为 10332 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10332:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 10332 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10332:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 10332 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10332:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1140-1 Deobfuscate/Decode Files Or Information

Done executing cleanup for test:
T1140-1 Deobfuscate/Decode Files Or Information

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1140-2 Certutil Rename and Decode

Done executing cleanup for test:
T1140-2 Certutil Rename and Decode

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1140-2 Certutil Rename and Decode

No Preqs Defined


T1140-2
**********************
Windows PowerShell 脚本开始
开始时间: 20230415173317
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 12276 的进程。”
Stop-Process : 找不到进程标识符为 12276 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12276:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 12276 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12276:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 12276 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12276:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1140-2 Certutil Rename and Decode

Done executing cleanup for test:
T1140-2 Certutil Rename and Decode

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1036-1 System File Copied to Unusual Location

Done executing cleanup for test:
T1036-1 System File Copied to Unusual Location

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1036-1 System File Copied to Unusual Location

No Preqs Defined


T1036-1
**********************
Windows PowerShell 脚本开始
开始时间: 20230415173405
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 9148 的进程。”
Stop-Process : 找不到进程标识符为 9148 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9148:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 9148 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9148:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 9148 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9148:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1036-1 System File Copied to Unusual Location

Done executing cleanup for test:
T1036-1 System File Copied to Unusual Location

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1036-2 Malware Masquerading and Execution from Zip File

Done executing cleanup for test:
T1036-2 Malware Masquerading and Execution from Zip File

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1036-2 Malware Masquerading and Execution from Zip File

Attempting to satisfy prereq:
Zip file must be present.

Prereq successfully met:
Zip file must be present.

T1036-2
**********************
Windows PowerShell 脚本开始
开始时间: 20230415173503
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 12820 的进程。”
Stop-Process : 找不到进程标识符为 12820 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12820:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 12820 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12820:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 12820 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12820:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1036-2 Malware Masquerading and Execution from Zip File

Done executing cleanup for test:
T1036-2 Malware Masquerading and Execution from Zip File

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1055-1 Shellcode execution via VBA

Done executing cleanup for test:
T1055-1 Shellcode execution via VBA

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1055-1 Shellcode execution via VBA

Attempting to satisfy prereq:
The 64-bit version of Microsoft Office must be installed

You will need to install Microsoft Word (64-bit) manually to meet this requirement
Failed to meet prereq: The 64-bit version of Microsoft Office must be installed
Attempting to satisfy prereq:
C:\AtomicRedTeam\atomics\T1055\src\x64\T1055-macrocode.txt must exist on disk at specified location

Prereq already met:
C:\AtomicRedTeam\atomics\T1055\src\x64\T1055-macrocode.txt must exist on disk at specified location

T1055-1
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1055-1 Shellcode execution via VBA

Done executing cleanup for test:
T1055-1 Shellcode execution via VBA

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1055-2 Remote Process Injection in LSASS via mimikatz

Done executing cleanup for test:
T1055-2 Remote Process Injection in LSASS via mimikatz

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1055-2 Remote Process Injection in LSASS via mimikatz

Attempting to satisfy prereq:
Mimikatz executor must exist on disk and at specified location (%tmp%\mimikatz\x64\mimikatz.exe)

Invoke-WebRequest : 无法分析响应内容，因为 Internet Explorer 引擎不可用，或者 Internet Explorer 的首次启动配置不完整。请
指定 UseBasicParsing 参数，然后再试一次。 
所在位置 行:4 字符: 12
+ $zipUrl = (Invoke-WebRequest $releases | ConvertFrom-Json)[0].assets. ...
    + CategoryInfo          : NotImplemented: (:) [Invoke-WebRequest], NotSupportedException
+            ~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
   d
    + FullyQualifiedErrorId : WebCmdletIEDomNotSupportedException,Microsoft.PowerShell.Commands.InvokeWebRequestComman 
Invoke-FetchFromZip : 无法将参数绑定到参数“zipUrl”，因为该参数为空字符串。
所在位置 行:7 字符: 21
+ Invoke-FetchFromZip $zipUrl "x64/mimikatz.exe" $basePath}
+                     ~~~~~~~
    + CategoryInfo          : InvalidData: (:) [Invoke-FetchFromZip]，ParameterBindingValidationException
    + FullyQualifiedErrorId : ParameterArgumentValidationErrorEmptyStringNotAllowed,Invoke-FetchFromZip
Failed to meet prereq: Mimikatz executor must exist on disk and at specified location (%tmp%\mimikatz\x64\mimikatz.exe)
Attempting to satisfy prereq:
PsExec tool from Sysinternals must exist on disk at specified location (C:\PSTools\PsExec.exe)

Prereq successfully met:
PsExec tool from Sysinternals must exist on disk at specified location (C:\PSTools\PsExec.exe)

T1055-2
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1055-2 Remote Process Injection in LSASS via mimikatz

Done executing cleanup for test:
T1055-2 Remote Process Injection in LSASS via mimikatz

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218-1 mavinject - Inject DLL into running process

Done executing cleanup for test:
T1218-1 mavinject - Inject DLL into running process

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218-1 mavinject - Inject DLL into running process

Attempting to satisfy prereq:
T1218.dll must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218\src\x64\T1218.dll)

Prereq already met:
T1218.dll must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218\src\x64\T1218.dll)

T1218-1
**********************
Windows PowerShell 脚本开始
开始时间: 20230415173902
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 5748 的进程。”
Stop-Process : 找不到进程标识符为 5748 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (5748:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 5748 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (5748:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 5748 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (5748:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218-1 mavinject - Inject DLL into running process

Done executing cleanup for test:
T1218-1 mavinject - Inject DLL into running process

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218-2 Register-CimProvider - Execute evil dll

Done executing cleanup for test:
T1218-2 Register-CimProvider - Execute evil dll

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218-2 Register-CimProvider - Execute evil dll

Attempting to satisfy prereq:
T1218-2.dll must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218\src\Win32\T1218-2.dll)

Prereq already met:
T1218-2.dll must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218\src\Win32\T1218-2.dll)

T1218-2
**********************
Windows PowerShell 脚本开始
开始时间: 20230415173951
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 13820 的进程。”
Stop-Process : 找不到进程标识符为 13820 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13820:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13820 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13820:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13820 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13820:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218-2 Register-CimProvider - Execute evil dll

Done executing cleanup for test:
T1218-2 Register-CimProvider - Execute evil dll

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218-3 InfDefaultInstall.exe .inf Execution

Done executing cleanup for test:
T1218-3 InfDefaultInstall.exe .inf Execution

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218-3 InfDefaultInstall.exe .inf Execution

Attempting to satisfy prereq:
INF file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218\src\Infdefaultinstall.inf)

Prereq already met:
INF file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218\src\Infdefaultinstall.inf)

T1218-3
**********************
Windows PowerShell 脚本开始
开始时间: 20230415174040
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 13532 的进程。”
Stop-Process : 找不到进程标识符为 13532 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13532:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13532 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13532:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13532 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13532:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218-3 InfDefaultInstall.exe .inf Execution

Done executing cleanup for test:
T1218-3 InfDefaultInstall.exe .inf Execution

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218-4 ProtocolHandler.exe Downloaded a Suspicious File

Done executing cleanup for test:
T1218-4 ProtocolHandler.exe Downloaded a Suspicious File

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218-4 ProtocolHandler.exe Downloaded a Suspicious File

Attempting to satisfy prereq:
Microsoft Word must be installed

You will need to install Microsoft Word manually to meet this requirement
Failed to meet prereq: Microsoft Word must be installed
T1218-4
**********************
Windows PowerShell 脚本开始
开始时间: 20230415174133
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 6904 的进程。”
Stop-Process : 找不到进程标识符为 6904 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (6904:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 6904 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (6904:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 6904 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (6904:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218-4 ProtocolHandler.exe Downloaded a Suspicious File

Done executing cleanup for test:
T1218-4 ProtocolHandler.exe Downloaded a Suspicious File

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218-5 Microsoft.Workflow.Compiler.exe Payload Execution

Done executing cleanup for test:
T1218-5 Microsoft.Workflow.Compiler.exe Payload Execution

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218-5 Microsoft.Workflow.Compiler.exe Payload Execution

Attempting to satisfy prereq:
.Net must be installed for this test to work correctly.

Prereq already met:
.Net must be installed for this test to work correctly.

T1218-5
**********************
Windows PowerShell 脚本开始
开始时间: 20230415174224
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 12188 的进程。”
Stop-Process : 找不到进程标识符为 12188 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12188:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 12188 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12188:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 12188 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12188:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218-5 Microsoft.Workflow.Compiler.exe Payload Execution

Done executing cleanup for test:
T1218-5 Microsoft.Workflow.Compiler.exe Payload Execution

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218-6 Renamed Microsoft.Workflow.Compiler.exe Payload Executions

Done executing cleanup for test:
T1218-6 Renamed Microsoft.Workflow.Compiler.exe Payload Executions

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218-6 Renamed Microsoft.Workflow.Compiler.exe Payload Executions

Attempting to satisfy prereq:
.Net must be installed for this test to work correctly.

Prereq already met:
.Net must be installed for this test to work correctly.

T1218-6
**********************
Windows PowerShell 脚本开始
开始时间: 20230415174316
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 11972 的进程。”
Stop-Process : 找不到进程标识符为 11972 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (11972:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 11972 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (11972:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 11972 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (11972:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218-6 Renamed Microsoft.Workflow.Compiler.exe Payload Executions

Done executing cleanup for test:
T1218-6 Renamed Microsoft.Workflow.Compiler.exe Payload Executions

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218-7 Invoke-ATHRemoteFXvGPUDisablementCommand base test

Done executing cleanup for test:
T1218-7 Invoke-ATHRemoteFXvGPUDisablementCommand base test

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218-7 Invoke-ATHRemoteFXvGPUDisablementCommand base test

Attempting to satisfy prereq:
The AtomicTestHarnesses module must be installed and Invoke-ATHRemoteFXvGPUDisablementCommand must be exported in the module.

Prereq successfully met:
The AtomicTestHarnesses module must be installed and Invoke-ATHRemoteFXvGPUDisablementCommand must be exported in the module.

T1218-7
**********************
Windows PowerShell 脚本开始
开始时间: 20230415174425
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 13776 的进程。”
Stop-Process : 找不到进程标识符为 13776 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13776:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13776 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13776:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13776 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13776:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218-7 Invoke-ATHRemoteFXvGPUDisablementCommand base test

Done executing cleanup for test:
T1218-7 Invoke-ATHRemoteFXvGPUDisablementCommand base test

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218-8 DiskShadow Command Execution

Done executing cleanup for test:
T1218-8 DiskShadow Command Execution

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218-8 DiskShadow Command Execution

Attempting to satisfy prereq:
txt file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218\src\T1218.txt)

Prereq already met:
txt file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218\src\T1218.txt)

Attempting to satisfy prereq:
DiskShadow.exe must exist on disk at specified location (C:\Windows\System32\diskshadow.exe)

DiskShadow.exe not found on disk at expected location
Failed to meet prereq: DiskShadow.exe must exist on disk at specified location (C:\Windows\System32\diskshadow.exe)
T1218-8
**********************
Windows PowerShell 脚本开始
开始时间: 20230415174524
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 10468 的进程。”
Stop-Process : 找不到进程标识符为 10468 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10468:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 10468 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10468:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 10468 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10468:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218-8 DiskShadow Command Execution

Done executing cleanup for test:
T1218-8 DiskShadow Command Execution

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218-9 Load Arbitrary DLL via Wuauclt (Windows Update Client)

Done executing cleanup for test:
T1218-9 Load Arbitrary DLL via Wuauclt (Windows Update Client)

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218-9 Load Arbitrary DLL via Wuauclt (Windows Update Client)

Attempting to satisfy prereq:
DLL to load must exist on disk as specified location (C:\AtomicRedTeam\atomics\T1218\bin\calc.dll)

Prereq already met:
DLL to load must exist on disk as specified location (C:\AtomicRedTeam\atomics\T1218\bin\calc.dll)

T1218-9
**********************
Windows PowerShell 脚本开始
开始时间: 20230415174614
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 8772 的进程。”
Stop-Process : 找不到进程标识符为 8772 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8772:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 8772 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8772:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 8772 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8772:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218-9 Load Arbitrary DLL via Wuauclt (Windows Update Client)

Done executing cleanup for test:
T1218-9 Load Arbitrary DLL via Wuauclt (Windows Update Client)

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218-10 Lolbin Gpscript logon option

Done executing cleanup for test:
T1218-10 Lolbin Gpscript logon option

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218-10 Lolbin Gpscript logon option

No Preqs Defined


T1218-10
**********************
Windows PowerShell 脚本开始
开始时间: 20230415174701
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 7828 的进程。”
Stop-Process : 找不到进程标识符为 7828 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (7828:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 7828 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (7828:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 7828 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (7828:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218-10 Lolbin Gpscript logon option

Done executing cleanup for test:
T1218-10 Lolbin Gpscript logon option

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218-11 Lolbin Gpscript startup option

Done executing cleanup for test:
T1218-11 Lolbin Gpscript startup option

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218-11 Lolbin Gpscript startup option

No Preqs Defined


T1218-11
**********************
Windows PowerShell 脚本开始
开始时间: 20230415174748
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 4244 的进程。”
Stop-Process : 找不到进程标识符为 4244 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (4244:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 4244 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (4244:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 4244 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (4244:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218-11 Lolbin Gpscript startup option

Done executing cleanup for test:
T1218-11 Lolbin Gpscript startup option

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218-12 Lolbas ie4uinit.exe use as proxy

Done executing cleanup for test:
T1218-12 Lolbas ie4uinit.exe use as proxy

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218-12 Lolbas ie4uinit.exe use as proxy

No Preqs Defined


T1218-12
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218-12 Lolbas ie4uinit.exe use as proxy

Done executing cleanup for test:
T1218-12 Lolbas ie4uinit.exe use as proxy

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1070.006-5 Windows - Modify file creation timestamp with PowerShell

Done executing cleanup for test:
T1070.006-5 Windows - Modify file creation timestamp with PowerShell

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1070.006-5 Windows - Modify file creation timestamp with PowerShell

Attempting to satisfy prereq:
A file must exist at the path ($env:TEMP\T1551.006_timestomp.txt) to change the creation time on

Prereq successfully met:
A file must exist at the path ($env:TEMP\T1551.006_timestomp.txt) to change the creation time on

T1070.006-5
**********************
Windows PowerShell 脚本开始
开始时间: 20230415174929
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 8268 的进程。”
Stop-Process : 找不到进程标识符为 8268 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8268:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 8268 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8268:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 8268 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8268:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1070.006-5 Windows - Modify file creation timestamp with PowerShell

Done executing cleanup for test:
T1070.006-5 Windows - Modify file creation timestamp with PowerShell

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1070.006-6 Windows - Modify file last modified timestamp with PowerShell

Done executing cleanup for test:
T1070.006-6 Windows - Modify file last modified timestamp with PowerShell

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1070.006-6 Windows - Modify file last modified timestamp with PowerShell

Attempting to satisfy prereq:
A file must exist at the path ($env:TEMP\T1551.006_timestomp.txt) to change the modified time on

Prereq already met:
A file must exist at the path ($env:TEMP\T1551.006_timestomp.txt) to change the modified time on

T1070.006-6
**********************
Windows PowerShell 脚本开始
开始时间: 20230415175021
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 3744 的进程。”
Stop-Process : 找不到进程标识符为 3744 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (3744:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 3744 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (3744:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 3744 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (3744:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1070.006-6 Windows - Modify file last modified timestamp with PowerShell

Done executing cleanup for test:
T1070.006-6 Windows - Modify file last modified timestamp with PowerShell

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1070.006-7 Windows - Modify file last access timestamp with PowerShell

Done executing cleanup for test:
T1070.006-7 Windows - Modify file last access timestamp with PowerShell

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1070.006-7 Windows - Modify file last access timestamp with PowerShell

Attempting to satisfy prereq:
A file must exist at the path ($env:TEMP\T1551.006_timestomp.txt) to change the last access time on

Prereq already met:
A file must exist at the path ($env:TEMP\T1551.006_timestomp.txt) to change the last access time on

T1070.006-7
**********************
Windows PowerShell 脚本开始
开始时间: 20230415175113
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 10244 的进程。”
Stop-Process : 找不到进程标识符为 10244 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10244:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 10244 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10244:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 10244 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10244:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1070.006-7 Windows - Modify file last access timestamp with PowerShell

Done executing cleanup for test:
T1070.006-7 Windows - Modify file last access timestamp with PowerShell

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1070.006-8 Windows - Timestomp a File

Done executing cleanup for test:
T1070.006-8 Windows - Timestomp a File

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1070.006-8 Windows - Timestomp a File

Attempting to satisfy prereq:
timestomp.ps1 must be present in $env:appdata\Microsoft.

Prereq successfully met:
timestomp.ps1 must be present in $env:appdata\Microsoft.

Attempting to satisfy prereq:
kxwn.lock must be present in $env:appdata\Microsoft.

目录: C:\Users\wangjian\AppData\Roaming\Microsoft
Mode                 LastWriteTime         Length Name                                                                 
----                 -------------         ------ ----                                                                 
-a----         2023/4/15     17:51              0 kxwn.lock
Prereq successfully met:
kxwn.lock must be present in $env:appdata\Microsoft.

T1070.006-8
**********************
Windows PowerShell 脚本开始
开始时间: 20230415175215
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 10656 的进程。”
Stop-Process : 找不到进程标识符为 10656 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10656:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 10656 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10656:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 10656 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10656:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1070.006-8 Windows - Timestomp a File

Done executing cleanup for test:
T1070.006-8 Windows - Timestomp a File

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1620-1 WinPwn - Reflectively load Mimik@tz into memory

Done executing cleanup for test:
T1620-1 WinPwn - Reflectively load Mimik@tz into memory

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1620-1 WinPwn - Reflectively load Mimik@tz into memory

No Preqs Defined


T1620-1
**********************
Windows PowerShell 脚本开始
开始时间: 20230415175304
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 13996 的进程。”
Stop-Process : 找不到进程标识符为 13996 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13996:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13996 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13996:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13996 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13996:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1620-1 WinPwn - Reflectively load Mimik@tz into memory

Done executing cleanup for test:
T1620-1 WinPwn - Reflectively load Mimik@tz into memory

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.003-1 CMSTP Executing Remote Scriptlet

Done executing cleanup for test:
T1218.003-1 CMSTP Executing Remote Scriptlet

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.003-1 CMSTP Executing Remote Scriptlet

Attempting to satisfy prereq:
INF file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.003\src\T1218.003.inf)

Prereq already met:
INF file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.003\src\T1218.003.inf)

T1218.003-1
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.003-1 CMSTP Executing Remote Scriptlet

Done executing cleanup for test:
T1218.003-1 CMSTP Executing Remote Scriptlet

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.003-2 CMSTP Executing UAC Bypass

Done executing cleanup for test:
T1218.003-2 CMSTP Executing UAC Bypass

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.003-2 CMSTP Executing UAC Bypass

Attempting to satisfy prereq:
INF file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.003\src\T1218.003_uacbypass.inf)

Prereq already met:
INF file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.003\src\T1218.003_uacbypass.inf)

T1218.003-2
PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.003-2 CMSTP Executing UAC Bypass

Done executing cleanup for test:
T1218.003-2 CMSTP Executing UAC Bypass

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1562.002-1 Disable Windows IIS HTTP Logging

Done executing cleanup for test:
T1562.002-1 Disable Windows IIS HTTP Logging

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1562.002-1 Disable Windows IIS HTTP Logging

No Preqs Defined


T1562.002-1
**********************
Windows PowerShell 脚本开始
开始时间: 20230415175528
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 9876 的进程。”
Stop-Process : 找不到进程标识符为 9876 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9876:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 9876 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9876:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 9876 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9876:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1562.002-1 Disable Windows IIS HTTP Logging

Done executing cleanup for test:
T1562.002-1 Disable Windows IIS HTTP Logging

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1562.002-2 Kill Event Log Service Threads

所在位置 行:1 字符: 1
+ & {Write-Host "NEED TO Restart-Computer TO ENSURE LOGGING RETURNS" -f ...
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
此脚本包含恶意内容，已被你的防病毒软件阻止。
    + CategoryInfo          : ParserError: (:) [], ParentContainsErrorRecordException
    + FullyQualifiedErrorId : ScriptContainedMaliciousContent
Done executing cleanup for test:
T1562.002-2 Kill Event Log Service Threads

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1562.002-2 Kill Event Log Service Threads

No Preqs Defined


T1562.002-2
**********************
Windows PowerShell 脚本开始
开始时间: 20230415175618
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 3112 的进程。”
Stop-Process : 找不到进程标识符为 3112 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (3112:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 3112 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (3112:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 3112 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (3112:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1562.002-2 Kill Event Log Service Threads

所在位置 行:1 字符: 1
+ & {Write-Host "NEED TO Restart-Computer TO ENSURE LOGGING RETURNS" -f ...
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
此脚本包含恶意内容，已被你的防病毒软件阻止。
    + CategoryInfo          : ParserError: (:) [], ParentContainsErrorRecordException
    + FullyQualifiedErrorId : ScriptContainedMaliciousContent
Done executing cleanup for test:
T1562.002-2 Kill Event Log Service Threads

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1562.002-3 Impair Windows Audit Log Policy

用法: AuditPol command [<sub-command><options>]
命令 (每次执行仅允许一个命令)
  /?               帮助(与上下文相关)
  /get             显示当前审核策略。
  /set             设置审核策略。
  /list            显示可选择的策略元素。
  /backup          将审核策略保存到文件。
  /restore         将审核策略从文件还原。
  /clear           清除审核策略。
  /remove          删除用户帐户的每用户审核策略。
  /resourceSACL    配置全局资源 SACL
有关每个命令的详细信息，请使用 AuditPol <command> /?
用法: AuditPol command [<sub-command><options>]
命令 (每次执行仅允许一个命令)
  /?               帮助(与上下文相关)
  /get             显示当前审核策略。
  /set             设置审核策略。
  /list            显示可选择的策略元素。
  /backup          将审核策略保存到文件。
  /clear           清除审核策略。
  /remove          删除用户帐户的每用户审核策略。
  /restore         将审核策略从文件还原。
有关每个命令的详细信息，请使用 AuditPol <command> /?
  /resourceSACL    配置全局资源 SACL
命令 (每次执行仅允许一个命令)
  /?               帮助(与上下文相关)
  /get             显示当前审核策略。
  /set             设置审核策略。
  /backup          将审核策略保存到文件。
  /restore         将审核策略从文件还原。
  /clear           清除审核策略。
  /remove          删除用户帐户的每用户审核策略。
  /resourceSACL    配置全局资源 SACL
  /list            显示可选择的策略元素。
有关每个命令的详细信息，请使用 AuditPol <command> /?
用法: AuditPol command [<sub-command><options>]
发生错误 0x00000057:
参数错误。
发生错误 0x00000057:
参数错误。
发生错误 0x00000057:
参数错误。
Done executing cleanup for test:
T1562.002-3 Impair Windows Audit Log Policy

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1562.002-3 Impair Windows Audit Log Policy

No Preqs Defined


T1562.002-3
**********************
Windows PowerShell 脚本开始
开始时间: 20230415175706
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 11308 的进程。”
Stop-Process : 找不到进程标识符为 11308 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (11308:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 11308 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (11308:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 11308 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (11308:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1562.002-3 Impair Windows Audit Log Policy

用法: AuditPol command [<sub-command><options>]
命令 (每次执行仅允许一个命令)
  /?               帮助(与上下文相关)
  /get             显示当前审核策略。
  /set             设置审核策略。
  /list            显示可选择的策略元素。
  /backup          将审核策略保存到文件。
  /restore         将审核策略从文件还原。
  /remove          删除用户帐户的每用户审核策略。
  /resourceSACL    配置全局资源 SACL
  /clear           清除审核策略。
有关每个命令的详细信息，请使用 AuditPol <command> /?
用法: AuditPol command [<sub-command><options>]
命令 (每次执行仅允许一个命令)
  /get             显示当前审核策略。
  /set             设置审核策略。
  /list            显示可选择的策略元素。
  /backup          将审核策略保存到文件。
  /restore         将审核策略从文件还原。
  /?               帮助(与上下文相关)
  /resourceSACL    配置全局资源 SACL
  /clear           清除审核策略。
  /remove          删除用户帐户的每用户审核策略。
有关每个命令的详细信息，请使用 AuditPol <command> /?
用法: AuditPol command [<sub-command><options>]
命令 (每次执行仅允许一个命令)
  /?               帮助(与上下文相关)
  /set             设置审核策略。
  /get             显示当前审核策略。
  /list            显示可选择的策略元素。
  /backup          将审核策略保存到文件。
  /restore         将审核策略从文件还原。
  /clear           清除审核策略。
  /remove          删除用户帐户的每用户审核策略。
  /resourceSACL    配置全局资源 SACL
有关每个命令的详细信息，请使用 AuditPol <command> /?
发生错误 0x00000057:
参数错误。
发生错误 0x00000057:
参数错误。
参数错误。
发生错误 0x00000057:
Done executing cleanup for test:
T1562.002-3 Impair Windows Audit Log Policy

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1562.002-4 Clear Windows Audit Policy Config

用法: AuditPol command [<sub-command><options>]
  /?               帮助(与上下文相关)
命令 (每次执行仅允许一个命令)
  /get             显示当前审核策略。
  /set             设置审核策略。
  /list            显示可选择的策略元素。
  /backup          将审核策略保存到文件。
  /restore         将审核策略从文件还原。
  /clear           清除审核策略。
  /resourceSACL    配置全局资源 SACL
  /remove          删除用户帐户的每用户审核策略。
有关每个命令的详细信息，请使用 AuditPol <command> /?
用法: AuditPol command [<sub-command><options>]
命令 (每次执行仅允许一个命令)
  /?               帮助(与上下文相关)
  /get             显示当前审核策略。
  /set             设置审核策略。
  /list            显示可选择的策略元素。
  /backup          将审核策略保存到文件。
  /restore         将审核策略从文件还原。
  /clear           清除审核策略。
  /remove          删除用户帐户的每用户审核策略。
  /resourceSACL    配置全局资源 SACL
有关每个命令的详细信息，请使用 AuditPol <command> /?
用法: AuditPol command [<sub-command><options>]
命令 (每次执行仅允许一个命令)
  /?               帮助(与上下文相关)
  /get             显示当前审核策略。
  /set             设置审核策略。
  /list            显示可选择的策略元素。
  /backup          将审核策略保存到文件。
  /restore         将审核策略从文件还原。
  /clear           清除审核策略。
  /resourceSACL    配置全局资源 SACL
  /remove          删除用户帐户的每用户审核策略。
有关每个命令的详细信息，请使用 AuditPol <command> /?
发生错误 0x00000057:
参数错误。
发生错误 0x00000057:
参数错误。
发生错误 0x00000057:
参数错误。
Done executing cleanup for test:
T1562.002-4 Clear Windows Audit Policy Config

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1562.002-4 Clear Windows Audit Policy Config

No Preqs Defined


T1562.002-4
**********************
Windows PowerShell 脚本开始
开始时间: 20230415175752
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 8460 的进程。”
Stop-Process : 找不到进程标识符为 8460 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8460:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 8460 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8460:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 8460 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8460:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1562.002-4 Clear Windows Audit Policy Config

用法: AuditPol command [<sub-command><options>]
命令 (每次执行仅允许一个命令)
  /get             显示当前审核策略。
  /?               帮助(与上下文相关)
  /list            显示可选择的策略元素。
  /set             设置审核策略。
  /restore         将审核策略从文件还原。
  /backup          将审核策略保存到文件。
  /clear           清除审核策略。
  /resourceSACL    配置全局资源 SACL
  /remove          删除用户帐户的每用户审核策略。
有关每个命令的详细信息，请使用 AuditPol <command> /?
命令 (每次执行仅允许一个命令)
  /?               帮助(与上下文相关)
  /get             显示当前审核策略。
用法: AuditPol command [<sub-command><options>]
  /set             设置审核策略。
  /backup          将审核策略保存到文件。
  /list            显示可选择的策略元素。
  /restore         将审核策略从文件还原。
  /clear           清除审核策略。
  /remove          删除用户帐户的每用户审核策略。
  /resourceSACL    配置全局资源 SACL
有关每个命令的详细信息，请使用 AuditPol <command> /?
命令 (每次执行仅允许一个命令)
用法: AuditPol command [<sub-command><options>]
  /?               帮助(与上下文相关)
  /get             显示当前审核策略。
  /set             设置审核策略。
  /list            显示可选择的策略元素。
  /backup          将审核策略保存到文件。
  /restore         将审核策略从文件还原。
  /clear           清除审核策略。
  /remove          删除用户帐户的每用户审核策略。
  /resourceSACL    配置全局资源 SACL
有关每个命令的详细信息，请使用 AuditPol <command> /?
发生错误 0x00000057:
参数错误。
发生错误 0x00000057:
参数错误。
发生错误 0x00000057:
参数错误。
Done executing cleanup for test:
T1562.002-4 Clear Windows Audit Policy Config

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1562.002-5 Disable Event Logging with wevtutil

Done executing cleanup for test:
T1562.002-5 Disable Event Logging with wevtutil

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1562.002-5 Disable Event Logging with wevtutil

No Preqs Defined


T1562.002-5
**********************
Windows PowerShell 脚本开始
开始时间: 20230415175839
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 9248 的进程。”
Stop-Process : 找不到进程标识符为 9248 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9248:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 9248 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9248:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 9248 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9248:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1562.002-5 Disable Event Logging with wevtutil

Done executing cleanup for test:
T1562.002-5 Disable Event Logging with wevtutil

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1562.002-6 Makes Eventlog blind with Phant0m

"Sorry you have to reboot"
Done executing cleanup for test:
T1562.002-6 Makes Eventlog blind with Phant0m

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1562.002-6 Makes Eventlog blind with Phant0m

Attempting to satisfy prereq:
Phant0m.exe must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1562.002\bin\Phant0m.exe)

Prereq already met:
Phant0m.exe must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1562.002\bin\Phant0m.exe)

T1562.002-6
**********************
Windows PowerShell 脚本开始
开始时间: 20230415175927
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 9972 的进程。”
Stop-Process : 找不到进程标识符为 9972 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9972:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 9972 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9972:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 9972 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9972:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1562.002-6 Makes Eventlog blind with Phant0m

"Sorry you have to reboot"
Done executing cleanup for test:
T1562.002-6 Makes Eventlog blind with Phant0m

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.002-1 Control Panel Items

Done executing cleanup for test:
T1218.002-1 Control Panel Items

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1218.002-1 Control Panel Items

Attempting to satisfy prereq:
Cpl file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.002\bin\calc.cpl)

Prereq already met:
Cpl file must exist on disk at specified location (C:\AtomicRedTeam\atomics\T1218.002\bin\calc.cpl)

T1218.002-1
**********************
Windows PowerShell 脚本开始
开始时间: 20230415180015
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 13956 的进程。”
Stop-Process : 找不到进程标识符为 13956 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13956:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13956 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13956:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13956 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13956:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1218.002-1 Control Panel Items

Done executing cleanup for test:
T1218.002-1 Control Panel Items

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1562.004-1 Disable Microsoft Defender Firewall

Done executing cleanup for test:
T1562.004-1 Disable Microsoft Defender Firewall

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1562.004-1 Disable Microsoft Defender Firewall

No Preqs Defined


T1562.004-1
**********************
Windows PowerShell 脚本开始
开始时间: 20230415180102
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 12720 的进程。”
Stop-Process : 找不到进程标识符为 12720 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12720:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 12720 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12720:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 12720 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12720:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1562.004-1 Disable Microsoft Defender Firewall

Done executing cleanup for test:
T1562.004-1 Disable Microsoft Defender Firewall

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1562.004-2 Disable Microsoft Defender Firewall via Registry

操作成功完成。
Done executing cleanup for test:
T1562.004-2 Disable Microsoft Defender Firewall via Registry

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1562.004-2 Disable Microsoft Defender Firewall via Registry

No Preqs Defined


T1562.004-2
**********************
Windows PowerShell 脚本开始
开始时间: 20230415180149
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 11008 的进程。”
Stop-Process : 找不到进程标识符为 11008 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (11008:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 11008 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (11008:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 11008 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (11008:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1562.004-2 Disable Microsoft Defender Firewall via Registry

操作成功完成。
Done executing cleanup for test:
T1562.004-2 Disable Microsoft Defender Firewall via Registry

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1562.004-3 Allow SMB and RDP on Microsoft Defender Firewall

Done executing cleanup for test:
T1562.004-3 Allow SMB and RDP on Microsoft Defender Firewall

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1562.004-3 Allow SMB and RDP on Microsoft Defender Firewall

No Preqs Defined


T1562.004-3
**********************
Windows PowerShell 脚本开始
开始时间: 20230415180236
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 11576 的进程。”
Stop-Process : 找不到进程标识符为 11576 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (11576:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 11576 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (11576:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 11576 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (11576:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1562.004-3 Allow SMB and RDP on Microsoft Defender Firewall

Done executing cleanup for test:
T1562.004-3 Allow SMB and RDP on Microsoft Defender Firewall

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1562.004-4 Opening ports for proxy - HARDRAIN

Done executing cleanup for test:
T1562.004-4 Opening ports for proxy - HARDRAIN

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1562.004-4 Opening ports for proxy - HARDRAIN

No Preqs Defined


T1562.004-4
**********************
Windows PowerShell 脚本开始
开始时间: 20230415180323
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 1012 的进程。”
Stop-Process : 找不到进程标识符为 1012 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (1012:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 1012 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (1012:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 1012 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (1012:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1562.004-4 Opening ports for proxy - HARDRAIN

Done executing cleanup for test:
T1562.004-4 Opening ports for proxy - HARDRAIN

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1562.004-5 Open a local port through Windows Firewall to any profile

Done executing cleanup for test:
T1562.004-5 Open a local port through Windows Firewall to any profile

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1562.004-5 Open a local port through Windows Firewall to any profile

No Preqs Defined


T1562.004-5
**********************
Windows PowerShell 脚本开始
开始时间: 20230415180412
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 10316 的进程。”
Stop-Process : 找不到进程标识符为 10316 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10316:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 10316 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10316:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 10316 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10316:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1562.004-5 Open a local port through Windows Firewall to any profile

Done executing cleanup for test:
T1562.004-5 Open a local port through Windows Firewall to any profile

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1562.004-6 Allow Executable Through Firewall Located in Non-Standard Location

Done executing cleanup for test:
T1562.004-6 Allow Executable Through Firewall Located in Non-Standard Location

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1562.004-6 Allow Executable Through Firewall Located in Non-Standard Location

No Preqs Defined


T1562.004-6
**********************
Windows PowerShell 脚本开始
开始时间: 20230415180503
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 12648 的进程。”
Stop-Process : 找不到进程标识符为 12648 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12648:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 12648 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12648:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 12648 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (12648:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1562.004-6 Allow Executable Through Firewall Located in Non-Standard Location

Done executing cleanup for test:
T1562.004-6 Allow Executable Through Firewall Located in Non-Standard Location

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1562.004-16 LockBit Black - Unusual Windows firewall registry modification -cmd

Done executing cleanup for test:
T1562.004-16 LockBit Black - Unusual Windows firewall registry modification -cmd

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1562.004-16 LockBit Black - Unusual Windows firewall registry modification -cmd

No Preqs Defined


T1562.004-16
**********************
Windows PowerShell 脚本开始
开始时间: 20230415180551
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 8940 的进程。”
Stop-Process : 找不到进程标识符为 8940 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8940:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 8940 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8940:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 8940 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8940:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1562.004-16 LockBit Black - Unusual Windows firewall registry modification -cmd

Done executing cleanup for test:
T1562.004-16 LockBit Black - Unusual Windows firewall registry modification -cmd

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1562.004-17 LockBit Black - Unusual Windows firewall registry modification -Powershell

Done executing cleanup for test:
T1562.004-17 LockBit Black - Unusual Windows firewall registry modification -Powershell

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1562.004-17 LockBit Black - Unusual Windows firewall registry modification -Powershell

No Preqs Defined


T1562.004-17
**********************
Windows PowerShell 脚本开始
开始时间: 20230415180640
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 1796 的进程。”
Stop-Process : 找不到进程标识符为 1796 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (1796:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 1796 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (1796:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 1796 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (1796:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1562.004-17 LockBit Black - Unusual Windows firewall registry modification -Powershell

Done executing cleanup for test:
T1562.004-17 LockBit Black - Unusual Windows firewall registry modification -Powershell

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1207-1 DCShadow (Active Directory)

Done executing cleanup for test:
T1207-1 DCShadow (Active Directory)

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1207-1 DCShadow (Active Directory)

Attempting to satisfy prereq:
Mimikatz executor must exist on disk and at specified location ($env:TEMP\mimikatz\x64\mimikatz.exe)

Invoke-WebRequest : 无法分析响应内容，因为 Internet Explorer 引擎不可用，或者 Internet Explorer 的首次启动配置不完整。请
所在位置 行:4 字符: 12
指定 UseBasicParsing 参数，然后再试一次。 
+ $zipUrl = (Invoke-WebRequest $releases | ConvertFrom-Json)[0].assets. ...
+            ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotImplemented: (:) [Invoke-WebRequest], NotSupportedException
    + FullyQualifiedErrorId : WebCmdletIEDomNotSupportedException,Microsoft.PowerShell.Commands.InvokeWebRequestComman 
   d
 
Invoke-FetchFromZip : 无法将参数绑定到参数“zipUrl”，因为该参数为空字符串。
所在位置 行:7 字符: 21
+ Invoke-FetchFromZip $zipUrl "x64/mimikatz.exe" $basePath}
+                     ~~~~~~~
    + CategoryInfo          : InvalidData: (:) [Invoke-FetchFromZip]，ParameterBindingValidationException
    + FullyQualifiedErrorId : ParameterArgumentValidationErrorEmptyStringNotAllowed,Invoke-FetchFromZip
Failed to meet prereq: Mimikatz executor must exist on disk and at specified location ($env:TEMP\mimikatz\x64\mimikatz.exe)
Attempting to satisfy prereq:
PsExec tool from Sysinternals must exist on disk at specified location (C:\PSTools\PsExec.exe)

Prereq already met:
PsExec tool from Sysinternals must exist on disk at specified location (C:\PSTools\PsExec.exe)

T1207-1
**********************
Windows PowerShell 脚本开始
开始时间: 20230415180742
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 7500 的进程。”
Stop-Process : 找不到进程标识符为 7500 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (7500:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 7500 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (7500:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 7500 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (7500:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1207-1 DCShadow (Active Directory)

Done executing cleanup for test:
T1207-1 DCShadow (Active Directory)

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1112-1 Modify Registry of Current User Profile - cmd

Done executing cleanup for test:
T1112-1 Modify Registry of Current User Profile - cmd

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1112-1 Modify Registry of Current User Profile - cmd

No Preqs Defined


T1112-1
**********************
Windows PowerShell 脚本开始
开始时间: 20230415180831
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 13776 的进程。”
Stop-Process : 找不到进程标识符为 13776 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13776:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13776 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13776:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13776 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13776:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1112-1 Modify Registry of Current User Profile - cmd

Done executing cleanup for test:
T1112-1 Modify Registry of Current User Profile - cmd

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1112-2 Modify Registry of Local Machine - cmd

Done executing cleanup for test:
T1112-2 Modify Registry of Local Machine - cmd

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1112-2 Modify Registry of Local Machine - cmd

No Preqs Defined


T1112-2
**********************
Windows PowerShell 脚本开始
开始时间: 20230415180919
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 7552 的进程。”
Stop-Process : 找不到进程标识符为 7552 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (7552:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 7552 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (7552:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 7552 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (7552:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1112-2 Modify Registry of Local Machine - cmd

Done executing cleanup for test:
T1112-2 Modify Registry of Local Machine - cmd

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1112-3 Modify registry to store logon credentials

Done executing cleanup for test:
T1112-3 Modify registry to store logon credentials

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1112-3 Modify registry to store logon credentials

No Preqs Defined


T1112-3
**********************
Windows PowerShell 脚本开始
开始时间: 20230415181007
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 11392 的进程。”
Stop-Process : 找不到进程标识符为 11392 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (11392:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 11392 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (11392:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 11392 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (11392:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1112-3 Modify registry to store logon credentials

Done executing cleanup for test:
T1112-3 Modify registry to store logon credentials

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1112-4 Add domain to Trusted sites Zone

Done executing cleanup for test:
T1112-4 Add domain to Trusted sites Zone

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1112-4 Add domain to Trusted sites Zone

No Preqs Defined


T1112-4
**********************
Windows PowerShell 脚本开始
开始时间: 20230415181057
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 3452 的进程。”
Stop-Process : 找不到进程标识符为 3452 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (3452:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 3452 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (3452:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 3452 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (3452:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1112-4 Add domain to Trusted sites Zone

Done executing cleanup for test:
T1112-4 Add domain to Trusted sites Zone

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1112-5 Javascript in registry

Done executing cleanup for test:
T1112-5 Javascript in registry

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1112-5 Javascript in registry

No Preqs Defined


T1112-5
**********************
Windows PowerShell 脚本开始
开始时间: 20230415181148
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 14156 的进程。”
Stop-Process : 找不到进程标识符为 14156 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (14156:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 14156 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (14156:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 14156 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (14156:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1112-5 Javascript in registry

Done executing cleanup for test:
T1112-5 Javascript in registry

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1112-6 Change Powershell Execution Policy to Bypass

Done executing cleanup for test:
T1112-6 Change Powershell Execution Policy to Bypass

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1112-6 Change Powershell Execution Policy to Bypass

No Preqs Defined


T1112-6
**********************
Windows PowerShell 脚本开始
开始时间: 20230415181240
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 11648 的进程。”
Stop-Process : 找不到进程标识符为 11648 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (11648:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 11648 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (11648:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 11648 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (11648:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1112-6 Change Powershell Execution Policy to Bypass

Done executing cleanup for test:
T1112-6 Change Powershell Execution Policy to Bypass

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1112-7 BlackByte Ransomware Registry Changes - CMD

Done executing cleanup for test:
T1112-7 BlackByte Ransomware Registry Changes - CMD

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1112-7 BlackByte Ransomware Registry Changes - CMD

No Preqs Defined


T1112-7
**********************
Windows PowerShell 脚本开始
开始时间: 20230415181329
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 14172 的进程。”
Stop-Process : 找不到进程标识符为 14172 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (14172:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 14172 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (14172:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 14172 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (14172:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1112-7 BlackByte Ransomware Registry Changes - CMD

Done executing cleanup for test:
T1112-7 BlackByte Ransomware Registry Changes - CMD

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1112-8 BlackByte Ransomware Registry Changes - Powershell

Done executing cleanup for test:
T1112-8 BlackByte Ransomware Registry Changes - Powershell

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1112-8 BlackByte Ransomware Registry Changes - Powershell

No Preqs Defined


T1112-8
**********************
Windows PowerShell 脚本开始
开始时间: 20230415181419
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 8292 的进程。”
Stop-Process : 找不到进程标识符为 8292 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8292:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 8292 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8292:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 8292 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (8292:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1112-8 BlackByte Ransomware Registry Changes - Powershell

Done executing cleanup for test:
T1112-8 BlackByte Ransomware Registry Changes - Powershell

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1112-9 Disable Windows Registry Tool

Done executing cleanup for test:
T1112-9 Disable Windows Registry Tool

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1112-9 Disable Windows Registry Tool

No Preqs Defined


T1112-9
**********************
Windows PowerShell 脚本开始
开始时间: 20230415181510
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 13884 的进程。”
Stop-Process : 找不到进程标识符为 13884 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13884:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13884 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13884:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13884 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13884:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1112-9 Disable Windows Registry Tool

Done executing cleanup for test:
T1112-9 Disable Windows Registry Tool

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1112-10 Disable Windows CMD application

Done executing cleanup for test:
T1112-10 Disable Windows CMD application

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1112-10 Disable Windows CMD application

No Preqs Defined


T1112-10
**********************
Windows PowerShell 脚本开始
开始时间: 20230415181602
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 13556 的进程。”
Stop-Process : 找不到进程标识符为 13556 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13556:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13556 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13556:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13556 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13556:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1112-10 Disable Windows CMD application

Done executing cleanup for test:
T1112-10 Disable Windows CMD application

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1112-11 Disable Windows Task Manager application

Done executing cleanup for test:
T1112-11 Disable Windows Task Manager application

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1112-11 Disable Windows Task Manager application

No Preqs Defined


T1112-11
**********************
Windows PowerShell 脚本开始
开始时间: 20230415181651
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 7564 的进程。”
Stop-Process : 找不到进程标识符为 7564 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (7564:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 7564 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (7564:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 7564 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (7564:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1112-11 Disable Windows Task Manager application

Done executing cleanup for test:
T1112-11 Disable Windows Task Manager application

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1112-12 Disable Windows Notification Center

Done executing cleanup for test:
T1112-12 Disable Windows Notification Center

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1112-12 Disable Windows Notification Center

No Preqs Defined


T1112-12
**********************
Windows PowerShell 脚本开始
开始时间: 20230415181739
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 13652 的进程。”
Stop-Process : 找不到进程标识符为 13652 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13652:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13652 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13652:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 13652 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (13652:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1112-12 Disable Windows Notification Center

Done executing cleanup for test:
T1112-12 Disable Windows Notification Center

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1112-13 Disable Windows Shutdown Button

Done executing cleanup for test:
T1112-13 Disable Windows Shutdown Button

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1112-13 Disable Windows Shutdown Button

No Preqs Defined


T1112-13
**********************
Windows PowerShell 脚本开始
开始时间: 20230415181827
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 10708 的进程。”
Stop-Process : 找不到进程标识符为 10708 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10708:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 10708 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10708:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 10708 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (10708:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1112-13 Disable Windows Shutdown Button

Done executing cleanup for test:
T1112-13 Disable Windows Shutdown Button

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1112-14 Disable Windows LogOff Button

Done executing cleanup for test:
T1112-14 Disable Windows LogOff Button

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1112-14 Disable Windows LogOff Button

No Preqs Defined


T1112-14
**********************
Windows PowerShell 脚本开始
开始时间: 20230415181915
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 9452 的进程。”
Stop-Process : 找不到进程标识符为 9452 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9452:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 9452 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9452:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 9452 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (9452:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1112-14 Disable Windows LogOff Button

Done executing cleanup for test:
T1112-14 Disable Windows LogOff Button

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1112-15 Disable Windows Change Password Feature

Done executing cleanup for test:
T1112-15 Disable Windows Change Password Feature

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
GetPrereq's for:
T1112-15 Disable Windows Change Password Feature

No Preqs Defined


T1112-15
**********************
Windows PowerShell 脚本开始
开始时间: 20230415182003
用户名: DESKTOP-SP5BHV2\wangjian
RunAs 用户: DESKTOP-SP5BHV2\wangjian
配置名称: 
计算机: DESKTOP-SP5BHV2 (Microsoft Windows NT 10.0.19044.0)
主机应用程序: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
进程 ID: 10412
PSVersion: 5.1.19041.2673
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.19041.2673
BuildVersion: 10.0.19041.2673
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
PS>CommandInvocation(Out-String):“Out-String”
>> ParameterBinding(Out-String): 名称 =“InputObject”；值 =“找不到进程标识符为 11744 的进程。”
Stop-Process : 找不到进程标识符为 11744 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (11744:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 11744 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (11744:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand
Stop-Process : 找不到进程标识符为 11744 的进程。
所在位置 C:\KGraph\AtomicRun\AtomicRunALL-3.ps1:37 字符: 6
+      Stop-Process -Id $processId
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (11744:Int32) [Stop-Process], ProcessCommandException
    + FullyQualifiedErrorId : NoProcessFoundForGivenId,Microsoft.PowerShell.Commands.StopProcessCommand

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
Executing cleanup for test:
T1112-15 Disable Windows Change Password Feature

Done executing cleanup for test:
T1112-15 Disable Windows Change Password Feature

PathToAtomicsFolder = C:\AtomicRedTeam\atomics
